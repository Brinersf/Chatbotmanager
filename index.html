<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChatBot Admin - Cl√≠nica de Est√©tica</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .chat-container {
            height: 60vh;
            overflow-y: auto;
            scroll-behavior: smooth;
        }
        
        @media (max-width: 768px) {
            .chat-container {
                height: 50vh;
            }
        }
        
        .message {
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .typing-indicator {
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }
        
        .quick-action {
            transition: all 0.2s ease;
        }
        
        .quick-action:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .treatment-card {
            transition: all 0.2s ease;
        }
        
        .treatment-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .tab-button.active {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            color: white;
        }
        
        .notification {
            animation: slideInRight 0.5s ease-out;
        }
        
        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100%);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .dropdown {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        
        .dropdown.open {
            max-height: 400px;
        }
        
        .treatment-detail-card {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
        }
        
        .treatment-detail-card:hover {
            border-color: #8b5cf6;
            box-shadow: 0 10px 30px rgba(139, 92, 246, 0.1);
        }
        
        /* Mobile Optimizations */
        @media (max-width: 768px) {
            .mobile-hidden {
                display: none !important;
            }
            
            .mobile-full {
                width: 100% !important;
            }
            
            .mobile-text-sm {
                font-size: 0.875rem !important;
            }
            
            .mobile-p-2 {
                padding: 0.5rem !important;
            }
            
            .mobile-p-3 {
                padding: 0.75rem !important;
            }
            
            .mobile-gap-2 {
                gap: 0.5rem !important;
            }
            
            .mobile-grid-1 {
                grid-template-columns: repeat(1, minmax(0, 1fr)) !important;
            }
            
            .mobile-grid-2 {
                grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
            }
            
            .mobile-max-w-xs {
                max-width: 20rem !important;
            }
            
            .mobile-sticky {
                position: sticky !important;
                top: 0 !important;
                z-index: 50 !important;
            }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <div class="gradient-bg text-white mobile-sticky">
        <div class="p-3 md:p-4">
            <div class="flex items-center justify-between mb-3 md:mb-4">
                <div class="flex items-center space-x-2 md:space-x-3">
                    <div id="clinicLogo" class="w-8 h-8 md:w-12 md:h-12 bg-white rounded-full flex items-center justify-center">
                        <span class="text-lg md:text-2xl">ü§ñ</span>
                    </div>
                    <div>
                        <h1 id="clinicName" class="text-sm md:text-xl font-bold">Cl√≠nica Bella Est√©tica</h1>
                        <p class="text-purple-100 text-xs md:text-sm mobile-hidden">Sistema de Gest√£o e ChatBot</p>
                    </div>
                </div>
                <div class="flex items-center space-x-2 md:space-x-4">
                    <div id="alertsIndicator" class="relative">
                        <div class="w-2 h-2 md:w-3 md:h-3 bg-green-400 rounded-full animate-pulse"></div>
                    </div>
                    <span class="text-xs md:text-sm mobile-hidden">Sistema Online</span>
                </div>
            </div>
            
            <!-- Navigation Tabs -->
            <div class="grid grid-cols-6 gap-1 md:flex md:space-x-2 md:gap-0">
                <button onclick="switchTab('chatbot')" id="chatbotTab" class="tab-button active flex flex-col items-center justify-center p-2 md:px-4 md:py-2 rounded-lg font-medium transition-colors">
                    <span class="text-lg md:text-base">üí¨</span>
                    <span class="hidden md:inline text-xs md:text-sm mt-1">ChatBot</span>
                </button>
                <button onclick="switchTab('admin')" id="adminTab" class="tab-button flex flex-col items-center justify-center p-2 md:px-4 md:py-2 rounded-lg font-medium transition-colors bg-white bg-opacity-20 hover:bg-opacity-30">
                    <span class="text-lg md:text-base">‚öôÔ∏è</span>
                    <span class="hidden md:inline text-xs md:text-sm mt-1">Admin</span>
                </button>
                <button onclick="switchTab('treatments')" id="treatmentsTab" class="tab-button flex flex-col items-center justify-center p-2 md:px-4 md:py-2 rounded-lg font-medium transition-colors bg-white bg-opacity-20 hover:bg-opacity-30">
                    <span class="text-lg md:text-base">‚ú®</span>
                    <span class="hidden md:inline text-xs md:text-sm mt-1">Procedimentos</span>
                </button>
                <button onclick="switchTab('appointments')" id="appointmentsTab" class="tab-button flex flex-col items-center justify-center p-2 md:px-4 md:py-2 rounded-lg font-medium transition-colors bg-white bg-opacity-20 hover:bg-opacity-30">
                    <span class="text-lg md:text-base">üìÖ</span>
                    <span class="hidden md:inline text-xs md:text-sm mt-1">Agenda</span>
                </button>
                <button onclick="switchTab('alerts')" id="alertsTab" class="tab-button flex flex-col items-center justify-center p-2 md:px-4 md:py-2 rounded-lg font-medium transition-colors bg-white bg-opacity-20 hover:bg-opacity-30">
                    <span class="text-lg md:text-base">üîî</span>
                    <span class="hidden md:inline text-xs md:text-sm mt-1">Alertas</span>
                </button>
                <button onclick="switchTab('settings')" id="settingsTab" class="tab-button flex flex-col items-center justify-center p-2 md:px-4 md:py-2 rounded-lg font-medium transition-colors bg-white bg-opacity-20 hover:bg-opacity-30">
                    <span class="text-lg md:text-base">üé®</span>
                    <span class="hidden md:inline text-xs md:text-sm mt-1">Config</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Notifications -->
    <div id="notifications" class="fixed top-20 right-4 z-50 space-y-2"></div>

    <!-- Main Container -->
    <div class="max-w-7xl mx-auto p-2 md:p-4">
        
        <!-- ChatBot Tab -->
        <div id="chatbotContent" class="tab-content active">
            <!-- Chat Messages -->
            <div id="chatContainer" class="chat-container bg-white rounded-xl shadow-lg mobile-p-3 p-6 mb-2 md:mb-4">
                <div id="messagesContainer" class="space-y-3 md:space-y-4">
                    <!-- Welcome message -->
                    <div class="message flex items-start space-x-2 md:space-x-3">
                        <div class="w-6 h-6 md:w-8 md:h-8 bg-purple-500 rounded-full flex items-center justify-center flex-shrink-0">
                            <span class="text-white text-xs md:text-sm">ü§ñ</span>
                        </div>
                        <div class="bg-gray-100 rounded-lg mobile-p-3 p-4 mobile-max-w-xs max-w-xs">
                            <p class="text-gray-800 text-sm md:text-base">Ol√°! üëã Sou a assistente virtual da Cl√≠nica Bella Est√©tica. Como posso ajud√°-la hoje?</p>
                        </div>
                    </div>
                </div>
                
                <!-- Typing indicator -->
                <div id="typingIndicator" class="hidden flex items-start space-x-2 md:space-x-3 mt-3 md:mt-4">
                    <div class="w-6 h-6 md:w-8 md:h-8 bg-purple-500 rounded-full flex items-center justify-center flex-shrink-0">
                        <span class="text-white text-xs md:text-sm">ü§ñ</span>
                    </div>
                    <div class="bg-gray-100 rounded-lg mobile-p-3 p-4">
                        <div class="typing-indicator flex space-x-1">
                            <div class="w-2 h-2 bg-gray-400 rounded-full"></div>
                            <div class="w-2 h-2 bg-gray-400 rounded-full"></div>
                            <div class="w-2 h-2 bg-gray-400 rounded-full"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="bg-white rounded-xl shadow-lg mobile-p-3 p-6 mb-2 md:mb-4">
                <h3 class="text-base md:text-lg font-semibold text-gray-800 mb-3 md:mb-4">üöÄ O que voc√™ gostaria de fazer?</h3>
                <div class="grid mobile-grid-1 grid-cols-1 md:grid-cols-2 mobile-gap-3 gap-4">
                    <button onclick="showSchedulingDropdown()" class="quick-action bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white mobile-p-4 p-6 rounded-lg text-center transition-colors shadow-lg">
                        <div class="text-2xl md:text-3xl mb-2 md:mb-3">üìÖ</div>
                        <div class="text-sm md:text-lg font-bold">Agendar Procedimento</div>
                        <div class="text-xs md:text-sm opacity-90 mt-1">Escolha o tratamento e marque seu hor√°rio</div>
                    </button>
                    <button onclick="showInfoDropdown()" class="quick-action bg-gradient-to-r from-blue-500 to-indigo-500 hover:from-blue-600 hover:to-indigo-600 text-white mobile-p-4 p-6 rounded-lg text-center transition-colors shadow-lg">
                        <div class="text-2xl md:text-3xl mb-2 md:mb-3">üìã</div>
                        <div class="text-sm md:text-lg font-bold">Saber Mais</div>
                        <div class="text-xs md:text-sm opacity-90 mt-1">Informa√ß√µes detalhadas sobre tratamentos</div>
                    </button>
                </div>
                
                <!-- Contact and Location buttons -->
                <div class="grid mobile-grid-2 grid-cols-2 mobile-gap-2 gap-3 mt-4">
                    <button onclick="quickAction('contato')" class="bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white mobile-p-3 p-4 rounded-lg text-center transition-colors">
                        <div class="text-lg md:text-xl mb-1">üìû</div>
                        <div class="text-xs md:text-sm font-medium">Contato</div>
                    </button>
                    <button onclick="showClinicLocation()" class="bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white mobile-p-3 p-4 rounded-lg text-center transition-colors">
                        <div class="text-lg md:text-xl mb-1">üìç</div>
                        <div class="text-xs md:text-sm font-medium">Localiza√ß√£o</div>
                    </button>
                </div>
            </div>

            <!-- Message Input -->
            <div class="bg-white rounded-xl shadow-lg mobile-p-3 p-4">
                <div class="flex space-x-2 md:space-x-3">
                    <input type="text" id="messageInput" placeholder="Digite sua mensagem..." 
                           class="flex-1 border border-gray-300 rounded-lg px-3 py-2 md:px-4 md:py-3 focus:outline-none focus:ring-2 focus:ring-purple-500 text-sm md:text-base"
                           onkeypress="handleKeyPress(event)">
                    <button onclick="sendMessage()" class="bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white px-4 py-2 md:px-6 md:py-3 rounded-lg font-medium transition-colors text-sm md:text-base">
                        üì§
                    </button>
                </div>
                
                <!-- Suggested Messages -->
                <div class="mt-2 md:mt-3 flex flex-wrap mobile-gap-2 gap-2">
                    <button onclick="sendSuggestedMessage('Quais tratamentos voc√™s oferecem?')" class="text-xs bg-gray-100 hover:bg-gray-200 text-gray-700 px-2 py-1 md:px-3 md:py-2 rounded-full transition-colors">
                        Tratamentos
                    </button>
                    <button onclick="sendSuggestedMessage('Tenho algumas d√∫vidas sobre os procedimentos')" class="text-xs bg-gray-100 hover:bg-gray-200 text-gray-700 px-2 py-1 md:px-3 md:py-2 rounded-full transition-colors">
                        D√∫vidas
                    </button>
                    <button onclick="sendSuggestedMessage('Como funciona o agendamento?')" class="text-xs bg-gray-100 hover:bg-gray-200 text-gray-700 px-2 py-1 md:px-3 md:py-2 rounded-full transition-colors">
                        Agendamento
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Admin Tab -->
        <div id="adminContent" class="tab-content">
            <div class="grid mobile-grid-1 grid-cols-1 lg:grid-cols-3 mobile-gap-2 gap-6 mb-4 md:mb-8">
                <!-- Stats Cards -->
                <div class="bg-white rounded-xl shadow-lg mobile-p-3 p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-sm md:text-lg font-semibold text-gray-800">Agendamentos Hoje</h3>
                            <p id="todayAppointments" class="text-2xl md:text-3xl font-bold text-purple-600">5</p>
                        </div>
                        <div class="w-8 h-8 md:w-12 md:h-12 bg-purple-100 rounded-full flex items-center justify-center">
                            <span class="text-lg md:text-2xl">üìÖ</span>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-lg mobile-p-3 p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-sm md:text-lg font-semibold text-gray-800">Receita do M√™s</h3>
                            <p id="monthlyRevenue" class="text-2xl md:text-3xl font-bold text-green-600">R$ 12.450</p>
                        </div>
                        <div class="w-8 h-8 md:w-12 md:h-12 bg-green-100 rounded-full flex items-center justify-center">
                            <span class="text-lg md:text-2xl">üí∞</span>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-lg mobile-p-3 p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-sm md:text-lg font-semibold text-gray-800">Clientes Ativos</h3>
                            <p id="activeClients" class="text-2xl md:text-3xl font-bold text-blue-600">127</p>
                        </div>
                        <div class="w-8 h-8 md:w-12 md:h-12 bg-blue-100 rounded-full flex items-center justify-center">
                            <span class="text-lg md:text-2xl">üë•</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Quick Actions -->
            <div class="bg-white rounded-xl shadow-lg mobile-p-3 p-6 mb-6">
                <h3 class="text-lg md:text-xl font-bold text-gray-800 mb-4 md:mb-6">üöÄ A√ß√µes R√°pidas</h3>
                <div class="grid mobile-grid-2 grid-cols-2 md:grid-cols-4 mobile-gap-2 gap-4">
                    <button onclick="manageAppointments()" class="bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white mobile-p-2 p-4 rounded-lg text-center transition-colors">
                        <div class="text-lg md:text-2xl mb-1 md:mb-2">üìÖ</div>
                        <div class="text-xs md:text-sm font-medium">Gerenciar Agendamento</div>
                    </button>
                    <button onclick="manageTreatments()" class="bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600 text-white mobile-p-2 p-4 rounded-lg text-center transition-colors">
                        <div class="text-lg md:text-2xl mb-1 md:mb-2">‚ú®</div>
                        <div class="text-xs md:text-sm font-medium">Procedimentos</div>
                    </button>
                    <button onclick="sendReminders()" class="bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white mobile-p-2 p-4 rounded-lg text-center transition-colors">
                        <div class="text-lg md:text-2xl mb-1 md:mb-2">üì±</div>
                        <div class="text-xs md:text-sm font-medium">Lembretes</div>
                    </button>
                    <button onclick="manageSchedule()" class="bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white mobile-p-2 p-4 rounded-lg text-center transition-colors">
                        <div class="text-lg md:text-2xl mb-1 md:mb-2">üìã</div>
                        <div class="text-xs md:text-sm font-medium">Gerenciar Agenda</div>
                    </button>
                </div>
            </div>
            
            <!-- Additional Tools -->
            <div class="bg-white rounded-xl shadow-lg mobile-p-3 p-6 mb-6">
                <h3 class="text-lg md:text-xl font-bold text-gray-800 mb-4 md:mb-6">üõ†Ô∏è Ferramentas Avan√ßadas</h3>
                <div class="grid mobile-grid-2 grid-cols-2 md:grid-cols-4 mobile-gap-2 gap-4">
                    <button onclick="updateAnalytics()" class="bg-gradient-to-r from-indigo-500 to-purple-500 hover:from-indigo-600 hover:to-purple-600 text-white mobile-p-2 p-4 rounded-lg text-center transition-colors">
                        <div class="text-lg md:text-2xl mb-1 md:mb-2">üìä</div>
                        <div class="text-xs md:text-sm font-medium">Atualizar Dados</div>
                    </button>
                    <button onclick="exportAppointments()" class="bg-gradient-to-r from-teal-500 to-green-500 hover:from-teal-600 hover:to-green-600 text-white mobile-p-2 p-4 rounded-lg text-center transition-colors">
                        <div class="text-lg md:text-2xl mb-1 md:mb-2">üì•</div>
                        <div class="text-xs md:text-sm font-medium">Exportar Agenda</div>
                    </button>
                    <button onclick="backupData()" class="bg-gradient-to-r from-yellow-500 to-orange-500 hover:from-yellow-600 hover:to-orange-600 text-white mobile-p-2 p-4 rounded-lg text-center transition-colors">
                        <div class="text-lg md:text-2xl mb-1 md:mb-2">üíæ</div>
                        <div class="text-xs md:text-sm font-medium">Backup</div>
                    </button>
                    <button class="bg-gradient-to-r from-green-500 to-emerald-500 text-white mobile-p-2 p-4 rounded-lg text-center cursor-default">
                        <div class="text-lg md:text-2xl mb-1 md:mb-2">üí¨</div>
                        <div class="text-xs md:text-sm font-medium">Suporte</div>
                    </button>
                </div>
            </div>
            
            <!-- ChatBot Management -->
            <div class="bg-white rounded-xl shadow-lg mobile-p-3 p-6">
                <h3 class="text-lg md:text-xl font-bold text-gray-800 mb-4 md:mb-6">ü§ñ Gerenciar ChatBot</h3>
                <div class="grid mobile-grid-1 grid-cols-1 md:grid-cols-3 mobile-gap-2 gap-4">
                    <button onclick="trainChatbot()" class="bg-gradient-to-r from-blue-500 to-indigo-500 hover:from-blue-600 hover:to-indigo-600 text-white mobile-p-2 p-4 rounded-lg text-center transition-colors">
                        <div class="text-lg md:text-2xl mb-1 md:mb-2">üß†</div>
                        <div class="text-xs md:text-sm font-medium">Treinar ChatBot</div>
                    </button>
                    <button onclick="resetChatbot()" class="bg-gradient-to-r from-red-500 to-pink-500 hover:from-red-600 hover:to-pink-600 text-white mobile-p-2 p-4 rounded-lg text-center transition-colors">
                        <div class="text-lg md:text-2xl mb-1 md:mb-2">üîÑ</div>
                        <div class="text-xs md:text-sm font-medium">Resetar Chat</div>
                    </button>
                    <button onclick="switchTab('settings')" class="bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white mobile-p-2 p-4 rounded-lg text-center transition-colors">
                        <div class="text-lg md:text-2xl mb-1 md:mb-2">üîó</div>
                        <div class="text-xs md:text-sm font-medium">Gerar Link</div>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Treatments Management Tab -->
        <div id="treatmentsContent" class="tab-content">
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-2xl font-bold text-gray-800">‚ú® Gerenciar Procedimentos</h3>
                    <button onclick="openTreatmentModal()" class="bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white px-6 py-3 rounded-lg font-medium transition-colors">
                        + Novo Procedimento
                    </button>
                </div>
                
                <div id="treatmentsList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Treatments will be populated here -->
                </div>
            </div>
        </div>
        
        <!-- Appointments Tab -->
        <div id="appointmentsContent" class="tab-content">
            <div class="bg-white rounded-xl shadow-lg p-6">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-2xl font-bold text-gray-800">üìÖ Agendamentos Autom√°ticos</h3>
                    <div class="text-sm text-gray-600">
                        ü§ñ Agendamentos feitos pelo ChatBot
                    </div>
                </div>
                
                <div id="appointmentsList" class="space-y-4">
                    <div class="border border-gray-200 rounded-lg p-4">
                        <div class="flex justify-between items-center">
                            <div>
                                <h4 class="font-semibold text-gray-800">Maria Silva</h4>
                                <p class="text-sm text-gray-600">Limpeza de Pele - R$ 150</p>
                                <p class="text-xs text-gray-500">15/01/2024 √†s 14:00</p>
                                <p class="text-xs text-blue-600">üì± (11) 99999-9999</p>
                            </div>
                            <div class="text-right">
                                <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm">Confirmado</span>
                                <p class="text-xs text-gray-500 mt-1">ID: APT123456</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="border border-gray-200 rounded-lg p-4">
                        <div class="flex justify-between items-center">
                            <div>
                                <h4 class="font-semibold text-gray-800">Ana Costa</h4>
                                <p class="text-sm text-gray-600">Massagem Relaxante - R$ 180</p>
                                <p class="text-xs text-gray-500">16/01/2024 √†s 10:00</p>
                                <p class="text-xs text-blue-600">üì± (11) 88888-8888</p>
                            </div>
                            <div class="text-right">
                                <span class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm">ChatBot</span>
                                <p class="text-xs text-gray-500 mt-1">ID: APT789012</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="text-center py-8 text-gray-500">
                        <p class="text-sm">ü§ñ Novos agendamentos aparecer√£o aqui automaticamente</p>
                        <p class="text-xs mt-1">Teste o ChatBot clicando em "Tratamentos" ‚Üí "Agendar Agora"</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Alerts Tab -->
        <div id="alertsContent" class="tab-content">
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-2xl font-bold text-gray-800 mb-6">üîî Alertas e Notifica√ß√µes</h3>
                
                <div class="space-y-4">
                    <div class="p-4 bg-blue-50 border border-blue-200 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <span class="text-2xl">üìÖ</span>
                            <div>
                                <h4 class="font-semibold text-blue-800">Agendamento para hoje</h4>
                                <p class="text-sm text-blue-600">Maria Silva - Limpeza de Pele √†s 14:00</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="p-4 bg-green-50 border border-green-200 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <span class="text-2xl">üí¨</span>
                            <div>
                                <h4 class="font-semibold text-green-800">Nova conversa no ChatBot</h4>
                                <p class="text-sm text-green-600">Cliente interessado em Botox</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <span class="text-2xl">‚è∞</span>
                            <div>
                                <h4 class="font-semibold text-yellow-800">Lembrete de confirma√ß√£o</h4>
                                <p class="text-sm text-yellow-600">Enviar lembrete para Ana Costa</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Settings Tab -->
        <div id="settingsContent" class="tab-content">
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <h3 class="text-xl font-bold text-gray-800 mb-4">üîó Gerador de Link do ChatBot</h3>
                <p class="text-gray-600 mb-6">Crie um link personalizado para compartilhar seu ChatBot no Instagram, WhatsApp, site e outras plataformas.</p>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Configuration -->
                    <div class="space-y-4">
                        <h4 class="font-semibold text-gray-800">‚öôÔ∏è Configura√ß√£o do Link</h4>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Nome do Link</label>
                            <div class="flex">
                                <span class="inline-flex items-center px-3 rounded-l-lg border border-r-0 border-gray-300 bg-gray-50 text-gray-500 text-sm">
                                    chatbot.link/
                                </span>
                                <input type="text" id="linkName" value="bella-estetica" class="flex-1 border border-gray-300 rounded-r-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-purple-500" placeholder="seu-nome">
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">WhatsApp de Destino</label>
                            <input type="tel" id="linkWhatsapp" value="(11) 9999-9999" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-purple-500">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tema do ChatBot</label>
                            <select id="linkTheme" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-purple-500">
                                <option value="purple">üíú Roxo (Padr√£o)</option>
                                <option value="pink">üíó Rosa</option>
                                <option value="blue">üíô Azul</option>
                                <option value="green">üíö Verde</option>
                                <option value="orange">üß° Laranja</option>
                            </select>
                        </div>
                        
                        <button onclick="generateChatbotLink()" class="w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white py-3 rounded-lg font-medium transition-colors">
                            üöÄ Gerar Link do ChatBot
                        </button>
                    </div>
                    
                    <!-- Generated Links -->
                    <div class="space-y-4">
                        <h4 class="font-semibold text-gray-800">üìã Links Gerados</h4>
                        
                        <!-- Direct Link -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">üîó Link Direto</label>
                            <div class="flex">
                                <input type="text" id="generatedLink" readonly class="flex-1 border border-gray-300 rounded-l-lg px-4 py-3 bg-gray-50 text-sm" placeholder="Clique em 'Gerar Link' para criar">
                                <button onclick="copyToClipboard('generatedLink')" class="px-4 py-3 bg-blue-500 hover:bg-blue-600 text-white rounded-r-lg font-medium transition-colors">
                                    üìã
                                </button>
                            </div>
                        </div>
                        
                        <!-- WhatsApp Share Message -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">üí¨ Mensagem para WhatsApp</label>
                            <div class="relative">
                                <textarea id="whatsappShareMessage" readonly rows="4" class="w-full border border-gray-300 rounded-lg px-4 py-3 bg-gray-50 text-sm" placeholder="Clique em 'Gerar Link' para criar"></textarea>
                                <button onclick="copyToClipboard('whatsappShareMessage')" class="absolute top-2 right-2 px-3 py-1 bg-green-500 hover:bg-green-600 text-white rounded text-xs font-medium transition-colors">
                                    üìã
                                </button>
                            </div>
                        </div>
                        
                        <!-- Action Buttons -->
                        <div class="grid grid-cols-2 gap-3">
                            <button onclick="previewChatbot()" class="bg-gray-500 hover:bg-gray-600 text-white py-2 rounded-lg font-medium transition-colors text-sm">
                                üëÅÔ∏è Pr√©via
                            </button>
                            <button onclick="shareLinkOnSocial('whatsapp')" class="bg-green-500 hover:bg-green-600 text-white py-2 rounded-lg font-medium transition-colors text-sm">
                                üì± Compartilhar
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Metrics Section -->
                <div class="mt-6 p-4 bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-lg">
                    <h5 class="font-semibold text-gray-800 mb-4">üìä M√©tricas do Link (√öltimos 30 dias)</h5>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <div class="text-center">
                            <div class="text-2xl font-bold text-blue-600" id="linkClicks">247</div>
                            <div class="text-sm text-gray-600">Cliques no Link</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold text-green-600" id="linkConversations">173</div>
                            <div class="text-sm text-gray-600">Conversas Iniciadas</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold text-purple-600" id="linkAppointments">52</div>
                            <div class="text-sm text-gray-600">Agendamentos</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold text-orange-600" id="linkConversionRate">21.1%</div>
                            <div class="text-sm text-gray-600">Taxa de Convers√£o</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Clinic Settings -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-xl font-bold text-gray-800 mb-4">üé® Configura√ß√µes da Cl√≠nica</h3>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Nome da Cl√≠nica</label>
                            <input type="text" id="clinicNameInput" value="Cl√≠nica Bella Est√©tica" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-purple-500">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Telefone/WhatsApp</label>
                            <input type="tel" id="clinicPhone" value="(11) 9999-9999" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-purple-500">
                        </div>
                    </div>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">E-mail</label>
                            <input type="email" id="clinicEmail" value="contato@bellaest√©tica.com.br" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-purple-500">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Endere√ßo</label>
                            <textarea id="clinicAddress" rows="2" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-purple-500">Rua das Flores, 123 - Centro
S√£o Paulo - SP</textarea>
                        </div>
                    </div>
                </div>
                
                <div class="mt-6 text-center space-x-4">
                    <button onclick="saveSettings()" class="bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white px-8 py-3 rounded-lg font-medium transition-colors">
                        üíæ Salvar Configura√ß√µes
                    </button>
                    <button onclick="restoreData()" class="bg-gradient-to-r from-blue-500 to-indigo-500 hover:from-blue-600 hover:to-indigo-600 text-white px-8 py-3 rounded-lg font-medium transition-colors">
                        üìÇ Restaurar Backup
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Treatment Modal -->
    <div id="treatmentModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50 p-2 md:p-4">
        <div class="bg-white rounded-2xl mobile-p-3 p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-4 md:mb-6">
                <h3 class="text-lg md:text-2xl font-bold text-gray-800">‚ú® Gerenciar Procedimento</h3>
                <button onclick="closeTreatmentModal()" class="text-gray-500 hover:text-gray-700 text-xl md:text-2xl">
                    &times;
                </button>
            </div>
            
            <form id="treatmentForm" class="space-y-3 md:space-y-4" onsubmit="saveTreatment(event)">
                <input type="hidden" id="treatmentId">
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-xs md:text-sm font-medium text-gray-700 mb-1 md:mb-2">Nome do Procedimento</label>
                        <input type="text" id="treatmentName" class="w-full border border-gray-300 rounded-lg px-3 py-2 md:px-4 md:py-3 focus:outline-none focus:ring-2 focus:ring-purple-500 text-sm md:text-base" required>
                    </div>
                    
                    <div>
                        <label class="block text-xs md:text-sm font-medium text-gray-700 mb-1 md:mb-2">Emoji/√çcone</label>
                        <input type="text" id="treatmentIcon" class="w-full border border-gray-300 rounded-lg px-3 py-2 md:px-4 md:py-3 focus:outline-none focus:ring-2 focus:ring-purple-500 text-sm md:text-base" placeholder="Ex: ‚ú®, üíÜ‚Äç‚ôÄÔ∏è, üß¥">
                    </div>
                </div>
                
                <div class="grid grid-cols-2 gap-2 md:gap-4">
                    <div>
                        <label class="block text-xs md:text-sm font-medium text-gray-700 mb-1 md:mb-2">Pre√ßo (R$)</label>
                        <input type="number" id="treatmentPrice" min="0" step="0.01" class="w-full border border-gray-300 rounded-lg px-3 py-2 md:px-4 md:py-3 focus:outline-none focus:ring-2 focus:ring-purple-500 text-sm md:text-base" required>
                    </div>
                    <div>
                        <label class="block text-xs md:text-sm font-medium text-gray-700 mb-1 md:mb-2">Dura√ß√£o (min)</label>
                        <input type="number" id="treatmentDuration" min="15" step="15" class="w-full border border-gray-300 rounded-lg px-3 py-2 md:px-4 md:py-3 focus:outline-none focus:ring-2 focus:ring-purple-500 text-sm md:text-base" required>
                    </div>
                </div>
                
                <div>
                    <label class="block text-xs md:text-sm font-medium text-gray-700 mb-1 md:mb-2">Descri√ß√£o B√°sica</label>
                    <textarea id="treatmentDescription" rows="2" class="w-full border border-gray-300 rounded-lg px-3 py-2 md:px-4 md:py-3 focus:outline-none focus:ring-2 focus:ring-purple-500 text-sm md:text-base" placeholder="Descri√ß√£o curta do procedimento..."></textarea>
                </div>
                
                <div>
                    <label class="block text-xs md:text-sm font-medium text-gray-700 mb-1 md:mb-2">
                        üìã Explica√ß√£o Detalhada para Cliente
                        <span class="text-xs text-gray-500">(Esta ser√° mostrada no ChatBot quando o cliente selecionar o tratamento)</span>
                    </label>
                    <textarea id="treatmentDetailedExplanation" rows="8" class="w-full border border-gray-300 rounded-lg px-3 py-2 md:px-4 md:py-3 focus:outline-none focus:ring-2 focus:ring-purple-500 text-sm md:text-base" placeholder="üìù COMO FUNCIONA:
Explica√ß√£o detalhada do procedimento...

‚ú® BENEF√çCIOS:
‚Ä¢ Benef√≠cio 1
‚Ä¢ Benef√≠cio 2
‚Ä¢ Benef√≠cio 3

‚è∞ DURA√á√ÉO E FREQU√äNCIA:
Tempo de sess√£o e recomenda√ß√µes...

üîí CUIDADOS PR√â-PROCEDIMENTO:
‚Ä¢ Cuidado 1
‚Ä¢ Cuidado 2

üíÜ‚Äç‚ôÄÔ∏è CUIDADOS P√ìS-PROCEDIMENTO:
‚Ä¢ Cuidado 1
‚Ä¢ Cuidado 2

‚ö†Ô∏è CONTRAINDICA√á√ïES:
Informa√ß√µes de seguran√ßa..."></textarea>
                    <div class="mt-2 text-xs text-gray-500">
                        üí° <strong>Dicas de formata√ß√£o:</strong> Use emojis, quebras de linha e ‚Ä¢ para listas. Seja detalhado e informativo!
                    </div>
                </div>
                
                <div class="flex mobile-gap-2 space-x-4 pt-2">
                    <button type="submit" class="flex-1 bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white py-2 md:py-3 rounded-lg font-medium transition-colors text-sm md:text-base">
                        üíæ Salvar Procedimento
                    </button>
                    <button type="button" onclick="closeTreatmentModal()" class="px-4 md:px-6 bg-gray-300 hover:bg-gray-400 text-gray-700 py-2 md:py-3 rounded-lg font-medium transition-colors text-sm md:text-base">
                        Cancelar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Global variables
        let selectedTreatment = null;
        let currentTab = 'chatbot';
        let editingTreatmentId = null;
        
        // System data with detailed explanations
        let treatments = {
            limpeza: { 
                id: 'limpeza', 
                name: 'Limpeza de Pele', 
                price: 150, 
                duration: 60, 
                icon: '‚ú®', 
                description: 'Limpeza profunda que remove impurezas e deixa a pele renovada.',
                detailedExplanation: `üìù **COMO FUNCIONA:**
A limpeza de pele √© um procedimento est√©tico que remove impurezas, cravos e c√©lulas mortas, deixando sua pele mais limpa, suave e radiante.

‚ú® **BENEF√çCIOS:**
‚Ä¢ Remove cravos e impurezas profundas
‚Ä¢ Desobstrui os poros
‚Ä¢ Melhora a textura da pele
‚Ä¢ Prepara a pele para outros tratamentos
‚Ä¢ Deixa a pele mais luminosa e saud√°vel

‚è∞ **DURA√á√ÉO E FREQU√äNCIA:**
‚Ä¢ Sess√£o: 60 minutos
‚Ä¢ Recomendado: A cada 30-45 dias
‚Ä¢ Resultados vis√≠veis imediatamente

üîí **CUIDADOS PR√â-PROCEDIMENTO:**
‚Ä¢ N√£o use produtos com √°cidos 48h antes
‚Ä¢ Evite exposi√ß√£o solar excessiva
‚Ä¢ Remova toda maquiagem antes do procedimento

üíÜ‚Äç‚ôÄÔ∏è **CUIDADOS P√ìS-PROCEDIMENTO:**
‚Ä¢ Use protetor solar diariamente
‚Ä¢ Evite maquiagem nas primeiras 6 horas
‚Ä¢ Hidrate bem a pele
‚Ä¢ N√£o manipule a pele tratada

‚ö†Ô∏è **CONTRAINDICA√á√ïES:**
‚Ä¢ Pele com les√µes ativas ou inflama√ß√µes
‚Ä¢ Uso recente de isotretino√≠na
‚Ä¢ Gravidez (consulte seu m√©dico)`
            },
            peeling: { 
                id: 'peeling', 
                name: 'Peeling Qu√≠mico', 
                price: 200, 
                duration: 45, 
                icon: 'üß¥', 
                description: 'Renova√ß√£o celular para uma pele mais uniforme e jovem.',
                detailedExplanation: `üìù **COMO FUNCIONA:**
O peeling qu√≠mico utiliza √°cidos para promover a renova√ß√£o celular, removendo camadas superficiais da pele e estimulando a forma√ß√£o de uma pele nova, mais uniforme e rejuvenescida.

‚ú® **BENEF√çCIOS:**
‚Ä¢ Reduz manchas e melasma
‚Ä¢ Diminui linhas finas e rugas superficiais
‚Ä¢ Melhora a textura da pele
‚Ä¢ Uniformiza o tom da pele
‚Ä¢ Estimula a produ√ß√£o de col√°geno
‚Ä¢ Reduz poros dilatados

‚è∞ **DURA√á√ÉO E FREQU√äNCIA:**
‚Ä¢ Sess√£o: 45 minutos
‚Ä¢ Protocolo: 4-6 sess√µes com intervalo de 15-21 dias
‚Ä¢ Manuten√ß√£o: A cada 3-4 meses

üîí **CUIDADOS PR√â-PROCEDIMENTO:**
‚Ä¢ Suspender uso de √°cidos 1 semana antes
‚Ä¢ N√£o fazer depila√ß√£o na √°rea 48h antes
‚Ä¢ Evitar exposi√ß√£o solar intensa
‚Ä¢ Informar sobre medicamentos em uso

üíÜ‚Äç‚ôÄÔ∏è **CUIDADOS P√ìS-PROCEDIMENTO:**
‚Ä¢ Usar protetor solar FPS 60+ diariamente
‚Ä¢ Aplicar hidratante espec√≠fico
‚Ä¢ N√£o remover crostas ou descama√ß√µes
‚Ä¢ Evitar exerc√≠cios intensos por 24h
‚Ä¢ N√£o usar maquiagem por 12h

‚ö†Ô∏è **CONTRAINDICA√á√ïES:**
‚Ä¢ Gravidez e amamenta√ß√£o
‚Ä¢ Pele bronzeada ou queimada
‚Ä¢ Herpes ativo na regi√£o
‚Ä¢ Uso de isotretino√≠na nos √∫ltimos 6 meses`
            },
            massagem: { 
                id: 'massagem', 
                name: 'Massagem Relaxante', 
                price: 180, 
                duration: 90, 
                icon: 'üíÜ‚Äç‚ôÄÔ∏è', 
                description: 'Massagem terap√™utica para relaxamento e bem-estar.',
                detailedExplanation: `üìù **COMO FUNCIONA:**
A massagem relaxante utiliza t√©cnicas suaves e movimentos r√≠tmicos para aliviar tens√µes musculares, promover relaxamento profundo e melhorar a circula√ß√£o sangu√≠nea.

‚ú® **BENEF√çCIOS:**
‚Ä¢ Reduz stress e ansiedade
‚Ä¢ Alivia tens√µes musculares
‚Ä¢ Melhora a circula√ß√£o sangu√≠nea
‚Ä¢ Promove relaxamento profundo
‚Ä¢ Melhora a qualidade do sono
‚Ä¢ Aumenta a sensa√ß√£o de bem-estar

‚è∞ **DURA√á√ÉO E FREQU√äNCIA:**
‚Ä¢ Sess√£o: 90 minutos
‚Ä¢ Recomendado: Semanal ou quinzenal
‚Ä¢ Pode ser feita regularmente para manuten√ß√£o

üîí **CUIDADOS PR√â-PROCEDIMENTO:**
‚Ä¢ Evite refei√ß√µes pesadas 2h antes
‚Ä¢ Hidrate-se bem
‚Ä¢ Comunique √°reas de tens√£o ou dor
‚Ä¢ Chegue com 10 minutos de anteced√™ncia

üíÜ‚Äç‚ôÄÔ∏è **CUIDADOS P√ìS-PROCEDIMENTO:**
‚Ä¢ Beba bastante √°gua
‚Ä¢ Evite atividades intensas por 2h
‚Ä¢ Mantenha-se aquecida
‚Ä¢ Descanse e relaxe ap√≥s o procedimento

‚ö†Ô∏è **CONTRAINDICA√á√ïES:**
‚Ä¢ Febre ou infec√ß√µes
‚Ä¢ Les√µes na pele ou feridas abertas
‚Ä¢ Trombose ou problemas circulat√≥rios graves
‚Ä¢ Primeiro trimestre da gravidez (consulte m√©dico)`
            },
            depilacao: { 
                id: 'depilacao', 
                name: 'Depila√ß√£o a Laser', 
                price: 120, 
                duration: 30, 
                icon: '‚ö°', 
                description: 'Remo√ß√£o definitiva de pelos com tecnologia laser.',
                detailedExplanation: `üìù **COMO FUNCIONA:**
A depila√ß√£o a laser utiliza luz pulsada que √© absorvida pela melanina do pelo, aquecendo e destruindo o fol√≠culo piloso, impedindo o crescimento de novos pelos.

‚ú® **BENEF√çCIOS:**
‚Ä¢ Redu√ß√£o permanente dos pelos
‚Ä¢ Pele mais lisa e macia
‚Ä¢ Elimina pelos encravados
‚Ä¢ Economia a longo prazo
‚Ä¢ Praticidade no dia a dia
‚Ä¢ Reduz irrita√ß√µes da pele

‚è∞ **DURA√á√ÉO E FREQU√äNCIA:**
‚Ä¢ Sess√£o: 30-60 minutos (varia por √°rea)
‚Ä¢ Protocolo: 6-10 sess√µes com intervalo de 30-45 dias
‚Ä¢ Manuten√ß√£o: 1-2 sess√µes anuais

üîí **CUIDADOS PR√â-PROCEDIMENTO:**
‚Ä¢ N√£o arrancar ou depilar com cera 30 dias antes
‚Ä¢ Fazer apenas a barba 24-48h antes
‚Ä¢ Evitar exposi√ß√£o solar 15 dias antes
‚Ä¢ N√£o usar autobronzeador
‚Ä¢ √Årea deve estar limpa e sem cremes

üíÜ‚Äç‚ôÄÔ∏è **CUIDADOS P√ìS-PROCEDIMENTO:**
‚Ä¢ Usar protetor solar FPS 60+ diariamente
‚Ä¢ Evitar exposi√ß√£o solar por 15 dias
‚Ä¢ N√£o usar produtos com √°lcool ou perfume
‚Ä¢ Aplicar compressas frias se houver vermelhid√£o
‚Ä¢ N√£o arrancar pelos que possam aparecer

‚ö†Ô∏è **CONTRAINDICA√á√ïES:**
‚Ä¢ Gravidez e amamenta√ß√£o
‚Ä¢ Pele bronzeada ou queimada
‚Ä¢ Uso de medicamentos fotossensibilizantes
‚Ä¢ Hist√≥rico de quel√≥ides
‚Ä¢ Infec√ß√µes ativas na √°rea`
            },
            botox: { 
                id: 'botox', 
                name: 'Aplica√ß√£o de Botox', 
                price: 400, 
                duration: 30, 
                icon: 'üíâ', 
                description: 'Suaviza√ß√£o de rugas e linhas de express√£o.',
                detailedExplanation: `üìù **COMO FUNCIONA:**
O Botox √© uma toxina botul√≠nica que, quando aplicada em pequenas doses, relaxa temporariamente os m√∫sculos respons√°veis pelas rugas de express√£o, suavizando linhas e prevenindo novas rugas.

‚ú® **BENEF√çCIOS:**
‚Ä¢ Suaviza rugas de express√£o
‚Ä¢ Previne forma√ß√£o de novas rugas
‚Ä¢ Resultado natural quando bem aplicado
‚Ä¢ Melhora a autoestima
‚Ä¢ Procedimento r√°pido e minimamente invasivo
‚Ä¢ Pode tratar hiperidrose (suor excessivo)

‚è∞ **DURA√á√ÉO E FREQU√äNCIA:**
‚Ä¢ Sess√£o: 30 minutos
‚Ä¢ Resultados aparecem em 3-7 dias
‚Ä¢ Dura√ß√£o do efeito: 4-6 meses
‚Ä¢ Reaplica√ß√£o conforme necess√°rio

üîí **CUIDADOS PR√â-PROCEDIMENTO:**
‚Ä¢ Evitar anti-inflamat√≥rios 1 semana antes
‚Ä¢ N√£o consumir √°lcool 24h antes
‚Ä¢ Informar sobre medicamentos e alergias
‚Ä¢ N√£o fazer exerc√≠cios intensos no dia

üíÜ‚Äç‚ôÄÔ∏è **CUIDADOS P√ìS-PROCEDIMENTO:**
‚Ä¢ N√£o deitar por 4 horas ap√≥s aplica√ß√£o
‚Ä¢ Evitar massagens na √°rea por 24h
‚Ä¢ N√£o fazer exerc√≠cios intensos por 24h
‚Ä¢ Evitar exposi√ß√£o ao calor excessivo
‚Ä¢ N√£o manipular a √°rea tratada

‚ö†Ô∏è **CONTRAINDICA√á√ïES:**
‚Ä¢ Gravidez e amamenta√ß√£o
‚Ä¢ Doen√ßas neuromusculares
‚Ä¢ Alergia √† toxina botul√≠nica
‚Ä¢ Infec√ß√µes na √°rea de aplica√ß√£o
‚Ä¢ Uso de anticoagulantes (avaliar caso a caso)`
            },
            preenchimento: { 
                id: 'preenchimento', 
                name: 'Preenchimento Labial', 
                price: 350, 
                duration: 45, 
                icon: 'üíã', 
                description: 'Volume e defini√ß√£o natural dos l√°bios.',
                detailedExplanation: `üìù **COMO FUNCIONA:**
O preenchimento labial utiliza √°cido hialur√¥nico para aumentar o volume, definir o contorno e hidratar os l√°bios, proporcionando um resultado natural e harmonioso.

‚ú® **BENEF√çCIOS:**
‚Ä¢ Aumenta volume dos l√°bios naturalmente
‚Ä¢ Define melhor o contorno labial
‚Ä¢ Hidrata e rejuvenesce os l√°bios
‚Ä¢ Corrige assimetrias
‚Ä¢ Suaviza linhas ao redor da boca
‚Ä¢ Resultado imediato e natural

‚è∞ **DURA√á√ÉO E FREQU√äNCIA:**
‚Ä¢ Sess√£o: 45 minutos
‚Ä¢ Resultado imediato
‚Ä¢ Dura√ß√£o: 8-12 meses
‚Ä¢ Retoque pode ser feito ap√≥s 15 dias se necess√°rio

üîí **CUIDADOS PR√â-PROCEDIMENTO:**
‚Ä¢ Evitar anti-inflamat√≥rios 1 semana antes
‚Ä¢ N√£o consumir √°lcool 24h antes
‚Ä¢ Tratar herpes labial se hist√≥rico
‚Ä¢ N√£o fazer procedimentos dent√°rios recentes
‚Ä¢ Informar sobre alergias e medicamentos

üíÜ‚Äç‚ôÄÔ∏è **CUIDADOS P√ìS-PROCEDIMENTO:**
‚Ä¢ Aplicar gelo nas primeiras horas
‚Ä¢ Evitar exerc√≠cios intensos por 24h
‚Ä¢ N√£o massagear a √°rea por 48h
‚Ä¢ Usar protetor labial com FPS
‚Ä¢ Evitar exposi√ß√£o ao calor excessivo
‚Ä¢ Dormir com a cabe√ßa elevada

‚ö†Ô∏è **CONTRAINDICA√á√ïES:**
‚Ä¢ Gravidez e amamenta√ß√£o
‚Ä¢ Herpes labial ativo
‚Ä¢ Alergia ao √°cido hialur√¥nico
‚Ä¢ Doen√ßas autoimunes ativas
‚Ä¢ Infec√ß√µes na √°rea de aplica√ß√£o`
            }
        };
        
        let clinicSettings = {
            name: 'Cl√≠nica Bella Est√©tica',
            logo: 'ü§ñ',
            phone: '(11) 9999-9999',
            whatsapp: '(11) 9999-9999',
            email: 'contato@bellaest√©tica.com.br',
            address: 'Rua das Flores, 123 - Centro\nS√£o Paulo - SP\nCEP: 01234-567'
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            initializeSystem();
            scrollToBottom();
        });

        function initializeSystem() {
            loadTreatmentsList();
        }

        // Tab Management
        function switchTab(tab) {
            currentTab = tab;
            
            // Update tab buttons
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
                button.classList.add('bg-white', 'bg-opacity-20', 'hover:bg-opacity-30');
            });
            
            document.getElementById(tab + 'Tab').classList.add('active');
            document.getElementById(tab + 'Tab').classList.remove('bg-white', 'bg-opacity-20', 'hover:bg-opacity-30');
            
            // Update content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            document.getElementById(tab + 'Content').classList.add('active');
            
            // Load specific content
            if (tab === 'treatments') {
                loadTreatmentsList();
            }
        }

        // ChatBot Functions
        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (message) {
                addMessage(message, 'user');
                input.value = '';
                
                showTypingIndicator();
                
                setTimeout(() => {
                    hideTypingIndicator();
                    generateResponse(message);
                }, 1500);
            }
        }

        function sendSuggestedMessage(message) {
            document.getElementById('messageInput').value = message;
            sendMessage();
        }

        function quickAction(action) {
            const actions = {
                'contato': 'Preciso das informa√ß√µes de contato'
            };
            
            const message = actions[action];
            if (message) {
                document.getElementById('messageInput').value = message;
                sendMessage();
            }
        }

        function showSchedulingDropdown() {
            addMessage('Quero agendar um procedimento', 'user');
            
            setTimeout(() => {
                const response = 'Perfeito! Escolha o procedimento que deseja agendar:';
                addMessage(response, 'bot');
                
                setTimeout(() => {
                    showTreatmentDropdownForScheduling();
                }, 1000);
            }, 1000);
        }

        function showInfoDropdown() {
            addMessage('Quero saber mais sobre os procedimentos', 'user');
            
            setTimeout(() => {
                const response = 'Claro! Sobre qual procedimento voc√™ gostaria de saber mais detalhes?';
                addMessage(response, 'bot');
                
                setTimeout(() => {
                    showTreatmentDropdownForInfo();
                }, 1000);
            }, 1000);
        }

        function showTreatmentDropdownForScheduling() {
            const container = document.getElementById('messagesContainer');
            const dropdownDiv = document.createElement('div');
            dropdownDiv.className = 'message flex items-start space-x-2 md:space-x-3';
            
            dropdownDiv.innerHTML = `
                <div class="w-6 h-6 md:w-8 md:h-8 bg-purple-500 rounded-full flex items-center justify-center flex-shrink-0">
                    <span class="text-white text-xs md:text-sm">ü§ñ</span>
                </div>
                <div class="bg-gradient-to-br from-purple-50 to-pink-50 border-2 border-purple-200 rounded-xl p-6 max-w-md w-full">
                    <div class="flex items-center space-x-3 mb-4">
                        <span class="text-2xl">üìÖ</span>
                        <div>
                            <h3 class="font-bold text-purple-800">Agendar Procedimento</h3>
                            <p class="text-sm text-purple-600">Selecione o tratamento desejado</p>
                        </div>
                    </div>
                    
                    <select id="schedulingTreatmentSelector" onchange="selectTreatmentForScheduling()" class="w-full border-2 border-purple-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white text-gray-800 font-medium">
                        <option value="">üìã Escolha seu procedimento...</option>
                        ${Object.values(treatments).map(treatment => `
                            <option value="${treatment.id}">${treatment.icon} ${treatment.name} - R$ ${treatment.price}</option>
                        `).join('')}
                    </select>
                    
                    <div class="mt-4 p-3 bg-white border border-purple-200 rounded-lg">
                        <p class="text-xs text-purple-700 text-center">
                            üí° <strong>Dica:</strong> Ap√≥s selecionar, voc√™ ver√° todas as informa√ß√µes e poder√° escolher data e hor√°rio!
                        </p>
                    </div>
                </div>
            `;
            
            container.appendChild(dropdownDiv);
            scrollToBottom();
        }

        function showTreatmentDropdownForInfo() {
            const container = document.getElementById('messagesContainer');
            const dropdownDiv = document.createElement('div');
            dropdownDiv.className = 'message flex items-start space-x-2 md:space-x-3';
            
            dropdownDiv.innerHTML = `
                <div class="w-6 h-6 md:w-8 md:h-8 bg-purple-500 rounded-full flex items-center justify-center flex-shrink-0">
                    <span class="text-white text-xs md:text-sm">ü§ñ</span>
                </div>
                <div class="bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-xl p-6 max-w-md w-full">
                    <div class="flex items-center space-x-3 mb-4">
                        <span class="text-2xl">üìã</span>
                        <div>
                            <h3 class="font-bold text-blue-800">Informa√ß√µes Detalhadas</h3>
                            <p class="text-sm text-blue-600">Selecione para ver detalhes completos</p>
                        </div>
                    </div>
                    
                    <select id="infoTreatmentSelector" onchange="selectTreatmentForInfo()" class="w-full border-2 border-blue-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white text-gray-800 font-medium">
                        <option value="">üìö Escolha o procedimento...</option>
                        ${Object.values(treatments).map(treatment => `
                            <option value="${treatment.id}">${treatment.icon} ${treatment.name}</option>
                        `).join('')}
                    </select>
                    
                    <div class="mt-4 p-3 bg-white border border-blue-200 rounded-lg">
                        <p class="text-xs text-blue-700 text-center">
                            üí° <strong>Voc√™ ver√°:</strong> Como funciona, benef√≠cios, cuidados, contraindica√ß√µes e muito mais!
                        </p>
                    </div>
                </div>
            `;
            
            container.appendChild(dropdownDiv);
            scrollToBottom();
        }

        function selectTreatmentForScheduling() {
            const selector = document.getElementById('schedulingTreatmentSelector');
            const treatmentId = selector.value;
            
            if (!treatmentId) return;
            
            const treatment = treatments[treatmentId];
            if (!treatment) return;
            
            // Add user message showing selection
            addMessage(`Quero agendar: ${treatment.name}`, 'user');
            
            // Show treatment booking card directly
            setTimeout(() => {
                const response = `Excelente escolha! Aqui est√£o todas as informa√ß√µes sobre ${treatment.name}:`;
                addMessage(response, 'bot');
                
                setTimeout(() => {
                    showTreatmentBookingCard(treatment.name);
                }, 1000);
            }, 1000);
        }

        function selectTreatmentForInfo() {
            const selector = document.getElementById('infoTreatmentSelector');
            const treatmentId = selector.value;
            
            if (!treatmentId) return;
            
            const treatment = treatments[treatmentId];
            if (!treatment) return;
            
            // Add user message showing selection
            addMessage(`Quero saber mais sobre: ${treatment.name}`, 'user');
            
            // Show detailed information card
            setTimeout(() => {
                const response = `Aqui est√£o todas as informa√ß√µes detalhadas sobre ${treatment.name}:`;
                addMessage(response, 'bot');
                
                setTimeout(() => {
                    showDetailedTreatmentInfo(treatment);
                }, 1000);
            }, 1000);
        }

        function addMessage(text, sender) {
            const container = document.getElementById('messagesContainer');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message flex items-start space-x-2 md:space-x-3';
            
            if (sender === 'user') {
                messageDiv.innerHTML = `
                    <div class="w-6 h-6 md:w-8 md:h-8 bg-blue-500 rounded-full flex items-center justify-center flex-shrink-0">
                        <span class="text-white text-xs md:text-sm">üë§</span>
                    </div>
                    <div class="bg-blue-500 text-white rounded-lg mobile-p-3 p-4 mobile-max-w-xs max-w-xs ml-auto">
                        <p class="text-sm md:text-base">${text}</p>
                    </div>
                `;
            } else {
                messageDiv.innerHTML = `
                    <div class="w-6 h-6 md:w-8 md:h-8 bg-purple-500 rounded-full flex items-center justify-center flex-shrink-0">
                        <span class="text-white text-xs md:text-sm">ü§ñ</span>
                    </div>
                    <div class="bg-gray-100 rounded-lg mobile-p-3 p-4 mobile-max-w-xs max-w-xs">
                        <div class="text-gray-800 text-sm md:text-base whitespace-pre-line">${text}</div>
                    </div>
                `;
            }
            
            container.appendChild(messageDiv);
            scrollToBottom();
        }

        function showTypingIndicator() {
            document.getElementById('typingIndicator').classList.remove('hidden');
            scrollToBottom();
        }

        function hideTypingIndicator() {
            document.getElementById('typingIndicator').classList.add('hidden');
        }

        function generateResponse(message) {
            const lowerMessage = message.toLowerCase();
            let response = '';
            
            if (lowerMessage.includes('ol√°') || lowerMessage.includes('oi') || lowerMessage.includes('bom dia')) {
                response = 'Ol√°! Como posso ajud√°-la hoje? üòä\n\nVoc√™ pode:\nüìÖ Agendar um procedimento\nüìã Saber mais sobre nossos tratamentos\nüìû Ver informa√ß√µes de contato\nüìç Conhecer nossa localiza√ß√£o';
            } else if (lowerMessage.includes('tratamento') || lowerMessage.includes('procedimento')) {
                response = 'Temos diversos procedimentos dispon√≠veis! O que voc√™ gostaria de fazer?';
                addMessage(response, 'bot');
                
                setTimeout(() => {
                    showTreatmentOptionsMenu();
                }, 1000);
                return;
            } else if (lowerMessage.includes('d√∫vida') || lowerMessage.includes('duvida') || lowerMessage.includes('pergunta')) {
                response = 'üòä Fico muito feliz em poder esclarecer suas d√∫vidas!\n\nSobre qual procedimento voc√™ gostaria de saber mais?';
                addMessage(response, 'bot');
                
                setTimeout(() => {
                    showTreatmentDropdownForInfo();
                }, 1500);
                return;
            } else if (lowerMessage.includes('pre√ßo') || lowerMessage.includes('valor')) {
                response = 'Nossos pre√ßos s√£o:\n\n' + 
                          Object.values(treatments).map(t => `üí∞ ${t.name}: R$ ${t.price},00`).join('\n') +
                          '\n\nTodos os valores incluem consulta e acompanhamento!\n\nGostaria de agendar algum procedimento?';
            } else if (lowerMessage.includes('agendar') || lowerMessage.includes('marcar')) {
                response = 'Perfeito! Vou te ajudar a agendar seu procedimento! üéâ';
                addMessage(response, 'bot');
                
                setTimeout(() => {
                    showTreatmentDropdownForScheduling();
                }, 1000);
                return;
            } else if (lowerMessage.includes('contato') || lowerMessage.includes('telefone') || lowerMessage.includes('endere√ßo')) {
                response = `Claro! Aqui est√£o todas as nossas informa√ß√µes de contato! üìû`;
                addMessage(response, 'bot');
                
                setTimeout(() => {
                    showContactCard();
                }, 1000);
                return;
            } else {
                response = 'Posso ajud√°-la com:\n\nüìÖ Agendar procedimentos\nüìã Informa√ß√µes detalhadas sobre tratamentos\nüìû Contato e localiza√ß√£o\nüí¨ Tirar d√∫vidas\n\nO que voc√™ gostaria de fazer?';
            }
            
            addMessage(response, 'bot');
        }

        function showTreatmentOptionsMenu() {
            const container = document.getElementById('messagesContainer');
            const optionsDiv = document.createElement('div');
            optionsDiv.className = 'message flex items-start space-x-2 md:space-x-3';
            
            optionsDiv.innerHTML = `
                <div class="w-6 h-6 md:w-8 md:h-8 bg-purple-500 rounded-full flex items-center justify-center flex-shrink-0">
                    <span class="text-white text-xs md:text-sm">ü§ñ</span>
                </div>
                <div class="bg-gray-100 rounded-lg p-4 max-w-md">
                    <p class="text-sm text-gray-700 mb-3">O que voc√™ gostaria de fazer?</p>
                    <div class="space-y-2">
                        <button onclick="showSchedulingDropdown()" 
                                class="w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white py-3 px-4 rounded-lg font-medium transition-colors">
                            üìÖ Agendar Procedimento
                        </button>
                        <button onclick="showInfoDropdown()" 
                                class="w-full bg-gradient-to-r from-blue-500 to-indigo-500 hover:from-blue-600 hover:to-indigo-600 text-white py-3 px-4 rounded-lg font-medium transition-colors">
                            üìã Ver Informa√ß√µes Detalhadas
                        </button>
                    </div>
                </div>
            `;
            
            container.appendChild(optionsDiv);
            scrollToBottom();
        }



        function showTreatmentDropdownForQuestions() {
            const container = document.getElementById('messagesContainer');
            const dropdownDiv = document.createElement('div');
            dropdownDiv.className = 'message flex items-start space-x-2 md:space-x-3';
            
            dropdownDiv.innerHTML = `
                <div class="w-6 h-6 md:w-8 md:h-8 bg-purple-500 rounded-full flex items-center justify-center flex-shrink-0">
                    <span class="text-white text-xs md:text-sm">ü§ñ</span>
                </div>
                <div class="bg-gray-100 rounded-lg mobile-p-3 p-4 max-w-md w-full">
                    <p class="text-gray-800 text-sm md:text-base mb-3">‚ùì Sobre qual procedimento voc√™ tem d√∫vidas?</p>
                    <select id="treatmentSelectorQuestions" onchange="selectTreatmentForQuestions()" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white">
                        <option value="">Selecione um procedimento...</option>
                        ${Object.values(treatments).map(treatment => `
                            <option value="${treatment.id}">${treatment.icon} ${treatment.name}</option>
                        `).join('')}
                    </select>
                </div>
            `;
            
            container.appendChild(dropdownDiv);
            scrollToBottom();
        }

        function selectTreatmentFromDropdown() {
            const selector = document.getElementById('treatmentSelector');
            const treatmentId = selector.value;
            
            if (!treatmentId) return;
            
            const treatment = treatments[treatmentId];
            if (!treatment) return;
            
            // Add user message showing selection
            addMessage(`Escolhi: ${treatment.name}`, 'user');
            
            // Show treatment booking card directly
            setTimeout(() => {
                const response = `Perfeito! Aqui est√£o todas as informa√ß√µes sobre ${treatment.name}! üìã`;
                addMessage(response, 'bot');
                
                setTimeout(() => {
                    showTreatmentBookingCard(treatment.name);
                }, 1000);
            }, 1000);
        }

        function selectTreatmentForQuestions() {
            const selector = document.getElementById('treatmentSelectorQuestions');
            const treatmentId = selector.value;
            
            if (!treatmentId) return;
            
            const treatment = treatments[treatmentId];
            if (!treatment) return;
            
            // Add user message showing selection
            addMessage(`Tenho d√∫vidas sobre: ${treatment.name}`, 'user');
            
            // Go directly to frequent questions without showing treatment card
            setTimeout(() => {
                const response = `Claro! Fico feliz em esclarecer suas d√∫vidas sobre ${treatment.name}! üòä\n\nVou te ajudar com as perguntas mais frequentes que recebemos:`;
                addMessage(response, 'bot');
                
                setTimeout(() => {
                    showFrequentQuestionsMenu(treatment.name);
                }, 1500);
            }, 1000);
        }

        function selectTreatmentFromDropdown() {
            const selector = document.getElementById('treatmentSelector');
            const treatmentId = selector.value;
            
            if (!treatmentId) return;
            
            const treatment = treatments[treatmentId];
            if (!treatment) return;
            
            // Add user message showing selection
            addMessage(`Escolhi: ${treatment.name}`, 'user');
            
            // Show treatment booking card directly
            setTimeout(() => {
                const response = `Perfeito! Aqui est√£o todas as informa√ß√µes sobre ${treatment.name}! üìã`;
                addMessage(response, 'bot');
                
                setTimeout(() => {
                    showTreatmentBookingCard(treatment.name);
                }, 1000);
            }, 1000);
        }

        function showDetailedTreatmentInfo(treatment) {
            const container = document.getElementById('messagesContainer');
            const detailDiv = document.createElement('div');
            detailDiv.className = 'message flex items-start space-x-2 md:space-x-3';
            
            detailDiv.innerHTML = `
                <div class="w-6 h-6 md:w-8 md:h-8 bg-purple-500 rounded-full flex items-center justify-center flex-shrink-0">
                    <span class="text-white text-xs md:text-sm">ü§ñ</span>
                </div>
                <div class="bg-gradient-to-br from-white to-blue-50 border-2 border-blue-200 rounded-xl p-6 max-w-2xl w-full shadow-lg">
                    <!-- Header do Procedimento -->
                    <div class="flex items-center space-x-4 mb-6">
                        <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center">
                            <span class="text-3xl">${treatment.icon}</span>
                        </div>
                        <div class="flex-1">
                            <h3 class="text-xl font-bold text-gray-800">${treatment.name}</h3>
                            <p class="text-sm text-gray-600">${treatment.description}</p>
                            <div class="flex items-center space-x-4 mt-2">
                                <span class="text-lg font-semibold text-green-600">R$ ${treatment.price},00</span>
                                <span class="text-sm text-gray-600">‚è±Ô∏è ${treatment.duration} minutos</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Informa√ß√µes Detalhadas -->
                    <div class="bg-white border border-blue-200 rounded-lg p-4 mb-6">
                        <div class="text-sm text-gray-700 whitespace-pre-line leading-relaxed">
                            ${treatment.detailedExplanation}
                        </div>
                    </div>
                    
                    <!-- Bot√µes de A√ß√£o -->
                    <div class="space-y-3">
                        <button onclick="scheduleFromInfo('${treatment.name}')" 
                                class="w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white py-4 px-6 rounded-lg font-bold text-lg transition-colors shadow-lg">
                            üìÖ Quero Agendar Este Procedimento
                        </button>
                        
                        <div class="grid grid-cols-1 gap-3">
                            <button onclick="showFrequentQuestions('${treatment.name}')" 
                                    class="bg-gradient-to-r from-blue-500 to-indigo-500 hover:from-blue-600 hover:to-indigo-600 text-white py-3 px-4 rounded-lg font-medium transition-colors text-center">
                                ‚ùì D√∫vidas Frequentes
                            </button>
                        </div>
                        
                        <button onclick="showOtherTreatments()" 
                                class="w-full bg-gradient-to-r from-gray-400 to-gray-500 hover:from-gray-500 hover:to-gray-600 text-white py-2 px-4 rounded-lg font-medium transition-colors">
                            üìã Ver Outros Procedimentos
                        </button>
                    </div>
                </div>
            `;
            
            container.appendChild(detailDiv);
            scrollToBottom();
        }

        function scheduleFromInfo(treatmentName) {
            const message = `Quero agendar: ${treatmentName}`;
            addMessage(message, 'user');
            
            setTimeout(() => {
                const response = `Perfeito! Vou te mostrar todas as op√ß√µes para agendar ${treatmentName}:`;
                addMessage(response, 'bot');
                
                setTimeout(() => {
                    showTreatmentBookingCard(treatmentName);
                }, 1000);
            }, 1000);
        }

        function contactAboutTreatment(treatmentName) {
            const message = `Ol√°! Vi as informa√ß√µes sobre ${treatmentName} no ChatBot e gostaria de tirar algumas d√∫vidas espec√≠ficas.

Podem me ajudar?`;
            
            openWhatsApp(message);
        }

        function showOtherTreatments() {
            const message = 'Quero ver outros procedimentos dispon√≠veis';
            addMessage(message, 'user');
            
            setTimeout(() => {
                const response = 'Claro! Aqui est√£o todos os nossos procedimentos:';
                addMessage(response, 'bot');
                
                setTimeout(() => {
                    showTreatmentDropdownForInfo();
                }, 1000);
            }, 1000);
        }

        function scheduleAppointment(treatmentName) {
            const message = `Gostaria de agendar: ${treatmentName}`;
            addMessage(message, 'user');
            
            setTimeout(() => {
                const response = `Perfeito! Vou mostrar todas as informa√ß√µes sobre ${treatmentName}! üìã`;
                addMessage(response, 'bot');
                
                setTimeout(() => {
                    showTreatmentBookingCard(treatmentName);
                }, 1000);
            }, 1000);
        }

        function showFrequentQuestions(treatmentName) {
            const message = `Tenho d√∫vidas sobre: ${treatmentName}`;
            addMessage(message, 'user');
            
            setTimeout(() => {
                const response = `Claro! Fico feliz em esclarecer suas d√∫vidas sobre ${treatmentName}! üòä\n\nVou te ajudar com as perguntas mais frequentes que recebemos:`;
                addMessage(response, 'bot');
                
                setTimeout(() => {
                    showFrequentQuestionsMenu(treatmentName);
                }, 1500);
            }, 1000);
        }

        function showGeneralQuestionsMenu() {
            const container = document.getElementById('messagesContainer');
            const questionsDiv = document.createElement('div');
            questionsDiv.className = 'message flex items-start space-x-2 md:space-x-3';
            
            questionsDiv.innerHTML = `
                <div class="w-6 h-6 md:w-8 md:h-8 bg-purple-500 rounded-full flex items-center justify-center flex-shrink-0">
                    <span class="text-white text-xs md:text-sm">ü§ñ</span>
                </div>
                <div class="bg-gradient-to-br from-purple-50 to-pink-50 border-2 border-purple-200 rounded-xl p-6 max-w-lg w-full">
                    <div class="flex items-center space-x-3 mb-4">
                        <span class="text-2xl">‚ùì</span>
                        <div>
                            <h3 class="font-bold text-gray-800">D√∫vidas Frequentes</h3>
                            <p class="text-sm text-gray-600">Escolha o procedimento para ver as d√∫vidas mais comuns</p>
                        </div>
                    </div>
                    
                    <div class="space-y-3">
                        ${Object.values(treatments).map(treatment => `
                            <button onclick="showFrequentQuestions('${treatment.name}')" 
                                    class="w-full text-left bg-white hover:bg-purple-50 border border-purple-200 hover:border-purple-400 rounded-lg p-4 transition-colors">
                                <div class="flex items-center space-x-3">
                                    <span class="text-2xl">${treatment.icon}</span>
                                    <div class="flex-1">
                                        <span class="text-gray-800 font-medium">${treatment.name}</span>
                                        <p class="text-xs text-gray-600 mt-1">Ver d√∫vidas frequentes</p>
                                    </div>
                                    <span class="text-purple-400">‚Üí</span>
                                </div>
                            </button>
                        `).join('')}
                        
                        <div class="mt-4 pt-4 border-t border-purple-200">
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-3">
                                <p class="text-xs text-blue-700 text-center">
                                    üí° <strong>Nosso ChatBot tem todas as respostas!</strong><br>
                                    Use o WhatsApp apenas para confirma√ß√µes de agendamento ou situa√ß√µes espec√≠ficas.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            container.appendChild(questionsDiv);
            scrollToBottom();
        }

        function showFrequentQuestionsMenu(treatmentName) {
            const container = document.getElementById('messagesContainer');
            const questionsDiv = document.createElement('div');
            questionsDiv.className = 'message flex items-start space-x-2 md:space-x-3';
            
            const treatment = Object.values(treatments).find(t => t.name === treatmentName);
            const questions = getFrequentQuestions(treatmentName);
            
            questionsDiv.innerHTML = `
                <div class="w-6 h-6 md:w-8 md:h-8 bg-purple-500 rounded-full flex items-center justify-center flex-shrink-0">
                    <span class="text-white text-xs md:text-sm">ü§ñ</span>
                </div>
                <div class="bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-xl p-6 max-w-lg w-full">
                    <div class="flex items-center space-x-3 mb-4">
                        <span class="text-2xl">${treatment.icon}</span>
                        <div>
                            <h3 class="font-bold text-gray-800">D√∫vidas sobre ${treatmentName}</h3>
                            <p class="text-sm text-gray-600">Clique na pergunta para ver a resposta</p>
                        </div>
                    </div>
                    
                    <div class="space-y-3">
                        ${questions.map((q, index) => `
                            <button onclick="answerFrequentQuestion('${treatmentName}', ${index})" 
                                    class="w-full text-left bg-white hover:bg-blue-50 border border-blue-200 hover:border-blue-400 rounded-lg p-4 transition-colors">
                                <div class="flex items-start space-x-3">
                                    <span class="text-blue-600 font-bold text-sm">${index + 1}.</span>
                                    <span class="text-gray-800 text-sm font-medium">${q.question}</span>
                                </div>
                            </button>
                        `).join('')}
                        
                        <div class="mt-4 pt-4 border-t border-blue-200 space-y-3">
                            <button onclick="proceedToCalendar('${treatmentName}')" 
                                    class="w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white py-3 px-4 rounded-lg font-medium transition-colors">
                                üìÖ Agendar ${treatmentName}
                            </button>
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-3">
                                <p class="text-xs text-blue-700 text-center">
                                    üí° <strong>Ainda com d√∫vidas?</strong> Nosso ChatBot tem todas as informa√ß√µes! Se precisar de algo espec√≠fico, entre em contato ap√≥s o agendamento.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            container.appendChild(questionsDiv);
            scrollToBottom();
        }

        function getFrequentQuestions(treatmentName) {
            const commonQuestions = {
                'Limpeza de Pele': [
                    {
                        question: "D√≥i durante o procedimento?",
                        answer: "A limpeza de pele pode causar um leve desconforto durante a extra√ß√£o de cravos, mas √© bem toler√°vel! üòä Usamos t√©cnicas suaves e produtos calmantes para minimizar qualquer inc√¥modo. A maioria das clientes relaxa durante o procedimento!"
                    },
                    {
                        question: "Posso usar maquiagem depois?",
                        answer: "Recomendamos evitar maquiagem nas primeiras 6 horas ap√≥s a limpeza para permitir que a pele respire e se recupere adequadamente. üíÑ Depois desse per√≠odo, voc√™ pode usar maquiagem normalmente!"
                    },
                    {
                        question: "Com que frequ√™ncia devo fazer?",
                        answer: "O ideal √© fazer limpeza de pele a cada 30-45 dias, dependendo do seu tipo de pele! üìÖ Peles mais oleosas podem precisar de intervalos menores, enquanto peles secas podem espa√ßar um pouco mais."
                    },
                    {
                        question: "Posso fazer se estiver com espinhas?",
                        answer: "Sim! A limpeza de pele √© excelente para tratar espinhas e prevenir novas! ‚ú® Nossos profissionais s√£o treinados para tratar peles com acne de forma segura e eficaz."
                    },
                    {
                        question: "Quanto tempo demora para ver resultados?",
                        answer: "Os resultados s√£o imediatos! üåü Logo ap√≥s o procedimento voc√™ j√° nota a pele mais limpa, suave e luminosa. Os benef√≠cios continuam melhorando nos dias seguintes!"
                    }
                ],
                'Peeling Qu√≠mico': [
                    {
                        question: "A pele vai descascar muito?",
                        answer: "A descama√ß√£o varia conforme o tipo de peeling! üß¥ Peelings mais suaves podem causar apenas uma leve renova√ß√£o, enquanto os mais intensos podem ter descama√ß√£o vis√≠vel por 3-7 dias. √â um processo natural e ben√©fico!"
                    },
                    {
                        question: "Posso fazer no ver√£o?",
                        answer: "Sim, mas com cuidados especiais! ‚òÄÔ∏è √â fundamental usar protetor solar FPS 60+ e evitar exposi√ß√£o solar direta. Muitas vezes recomendamos fazer no outono/inverno para melhores resultados."
                    },
                    {
                        question: "Quantas sess√µes preciso fazer?",
                        answer: "Geralmente recomendamos 4-6 sess√µes com intervalo de 15-21 dias para resultados √≥timos! üìä O n√∫mero exato depende do seu objetivo e tipo de pele. Avaliamos caso a caso!"
                    },
                    {
                        question: "Pode clarear manchas escuras?",
                        answer: "Sim! O peeling √© excelente para tratar melasma, manchas solares e hiperpigmenta√ß√£o! ‚ú® Os √°cidos promovem renova√ß√£o celular e clareamento gradual das manchas."
                    },
                    {
                        question: "D√≥i durante a aplica√ß√£o?",
                        answer: "Pode haver uma sensa√ß√£o de ard√™ncia leve a moderada durante os primeiros minutos, que √© normal! üî• Usamos t√©cnicas para minimizar o desconforto e o resultado vale muito a pena!"
                    }
                ],
                'Massagem Relaxante': [
                    {
                        question: "Quanto tempo dura o efeito relaxante?",
                        answer: "Os benef√≠cios podem durar de 3-7 dias! üòå Muitas clientes relatam melhor qualidade do sono e redu√ß√£o do stress por v√°rios dias ap√≥s a sess√£o."
                    },
                    {
                        question: "Posso fazer se estiver gr√°vida?",
                        answer: "Sim, mas com adapta√ß√µes especiais! ü§∞ Evitamos o primeiro trimestre e usamos t√©cnicas espec√≠ficas para gestantes. Sempre consulte seu m√©dico antes!"
                    },
                    {
                        question: "Que tipo de √≥leo voc√™s usam?",
                        answer: "Usamos √≥leos naturais e hipoalerg√™nicos de alta qualidade! üåø Temos op√ß√µes como √≥leo de coco, am√™ndoas e aromaterapia. Podemos adaptar conforme sua prefer√™ncia!"
                    },
                    {
                        question: "Posso fazer se tiver dores nas costas?",
                        answer: "Sim! A massagem relaxante pode ajudar muito com tens√µes musculares! üíÜ‚Äç‚ôÄÔ∏è Nossos terapeutas s√£o treinados para trabalhar √°reas de tens√£o de forma segura e eficaz."
                    },
                    {
                        question: "Preciso tirar toda a roupa?",
                        answer: "Voc√™ fica apenas com a roupa √≠ntima e usamos len√ß√≥is para cobrir! üõèÔ∏è Seu conforto e privacidade s√£o nossa prioridade. Voc√™ pode manter o que se sentir confort√°vel!"
                    }
                ],
                'Depila√ß√£o a Laser': [
                    {
                        question: "D√≥i muito durante o laser?",
                        answer: "A sensa√ß√£o √© comparada a um 'belisc√£o' r√°pido! ‚ö° Usamos equipamentos modernos com resfriamento que minimizam o desconforto. A maioria das clientes tolera muito bem!"
                    },
                    {
                        question: "Quantas sess√µes preciso fazer?",
                        answer: "Geralmente 6-10 sess√µes com intervalo de 30-45 dias! üìÖ O n√∫mero varia conforme √°rea, tipo de pelo e cor da pele. Cada pessoa responde de forma √∫nica!"
                    },
                    {
                        question: "Posso me depilar entre as sess√µes?",
                        answer: "Apenas com l√¢mina! ü™í Nunca arranque, use cera ou pin√ßa entre as sess√µes, pois isso atrapalha o tratamento. A l√¢mina pode ser usada normalmente!"
                    },
                    {
                        question: "Funciona em pelos brancos/grisalhos?",
                        answer: "O laser funciona melhor em pelos escuros! üéØ Pelos brancos ou muito claros n√£o respondem bem ao laser tradicional. Avaliamos cada caso individualmente!"
                    },
                    {
                        question: "Posso fazer no ver√£o?",
                        answer: "Sim, mas evite exposi√ß√£o solar 15 dias antes e depois! ‚òÄÔ∏è Use protetor solar FPS 60+ diariamente. Muitas pessoas preferem come√ßar no outono/inverno!"
                    }
                ],
                'Aplica√ß√£o de Botox': [
                    {
                        question: "Quando vou ver os resultados?",
                        answer: "Os primeiros efeitos aparecem em 3-7 dias e o resultado completo em 15 dias! ‚è∞ √â um processo gradual e natural, sem mudan√ßas bruscas na express√£o!"
                    },
                    {
                        question: "Vai ficar com cara de 'congelado'?",
                        answer: "N√£o! Quando bem aplicado, o resultado √© natural! üòä Nosso objetivo √© suavizar rugas mantendo suas express√µes naturais. Voc√™ continuar√° sendo voc√™!"
                    },
                    {
                        question: "Quanto tempo dura o efeito?",
                        answer: "Geralmente 4-6 meses! ‚è≥ A dura√ß√£o varia conforme metabolismo, √°rea tratada e quantidade aplicada. Com aplica√ß√µes regulares, pode durar mais tempo!"
                    },
                    {
                        question: "Posso fazer exerc√≠cios depois?",
                        answer: "Evite exerc√≠cios intensos por 24 horas! üèÉ‚Äç‚ôÄÔ∏è Tamb√©m n√£o deite por 4 horas ap√≥s a aplica√ß√£o. Atividades leves est√£o liberadas no dia seguinte!"
                    },
                    {
                        question: "Tem efeitos colaterais?",
                        answer: "Efeitos s√£o raros e tempor√°rios! üíâ Pode haver leve vermelhid√£o ou pequenos hematomas no local da aplica√ß√£o, que desaparecem em poucos dias!"
                    }
                ],
                'Preenchimento Labial': [
                    {
                        question: "Vai ficar com 'boca de pato'?",
                        answer: "N√£o! Nosso foco √© resultado natural e harmonioso! üíã Respeitamos o formato natural dos seus l√°bios, apenas real√ßando e dando volume sutil!"
                    },
                    {
                        question: "D√≥i durante a aplica√ß√£o?",
                        answer: "Usamos anest√©sico t√≥pico para minimizar o desconforto! üòå A sensa√ß√£o √© de leve press√£o. A maioria das clientes tolera muito bem o procedimento!"
                    },
                    {
                        question: "Quanto tempo dura o incha√ßo?",
                        answer: "O incha√ßo √© maior nas primeiras 24-48 horas! üßä Aplicar gelo ajuda muito. O resultado final aparece ap√≥s 15 dias quando o incha√ßo diminui completamente!"
                    },
                    {
                        question: "Posso beijar depois do procedimento?",
                        answer: "Evite beijos e press√£o nos l√°bios por 24-48 horas! üíè Isso ajuda na cicatriza√ß√£o e evita deslocamento do produto. Depois est√° liberado!"
                    },
                    {
                        question: "O resultado fica natural?",
                        answer: "Sim! Usamos t√©cnicas modernas para resultado natural! ‚ú® O √°cido hialur√¥nico integra-se naturalmente aos tecidos, proporcionando volume e hidrata√ß√£o naturais!"
                    }
                ]
            };
            
            return commonQuestions[treatmentName] || [
                {
                    question: "Qual o tempo de dura√ß√£o do procedimento?",
                    answer: "O procedimento tem dura√ß√£o m√©dia conforme descrito nas informa√ß√µes do tratamento. Nossos profissionais trabalham com calma para garantir o melhor resultado!"
                },
                {
                    question: "Preciso de algum preparo especial?",
                    answer: "Sim! Cada procedimento tem seus cuidados espec√≠ficos. Nossa equipe te orientar√° sobre todos os preparos necess√°rios antes da sess√£o!"
                },
                {
                    question: "Posso fazer outros procedimentos no mesmo dia?",
                    answer: "Depende dos procedimentos! Alguns podem ser combinados, outros precisam de intervalo. Avaliamos cada caso para sua seguran√ßa e melhores resultados!"
                }
            ];
        }

        function answerFrequentQuestion(treatmentName, questionIndex) {
            const questions = getFrequentQuestions(treatmentName);
            const selectedQuestion = questions[questionIndex];
            
            if (!selectedQuestion) return;
            
            // Add user message
            addMessage(selectedQuestion.question, 'user');
            
            // Add bot response with rapport
            setTimeout(() => {
                const response = `${selectedQuestion.answer}\n\nüòä Espero ter esclarecido sua d√∫vida! Tem mais alguma pergunta sobre ${treatmentName}?`;
                addMessage(response, 'bot');
                
                // Show options to continue
                setTimeout(() => {
                    showQuestionFollowUp(treatmentName);
                }, 1500);
            }, 1000);
        }

        function showQuestionFollowUp(treatmentName) {
            const container = document.getElementById('messagesContainer');
            const followUpDiv = document.createElement('div');
            followUpDiv.className = 'message flex items-start space-x-2 md:space-x-3';
            
            followUpDiv.innerHTML = `
                <div class="w-6 h-6 md:w-8 md:h-8 bg-purple-500 rounded-full flex items-center justify-center flex-shrink-0">
                    <span class="text-white text-xs md:text-sm">ü§ñ</span>
                </div>
                <div class="bg-gray-100 rounded-lg p-4 max-w-md">
                    <p class="text-sm text-gray-700 mb-3">O que voc√™ gostaria de fazer agora?</p>
                    <div class="space-y-2">
                        <button onclick="proceedToCalendar('${treatmentName}')" 
                                class="w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white py-3 px-4 rounded-lg font-medium transition-colors">
                            üìÖ Agendar ${treatmentName}
                        </button>
                        <button onclick="showFrequentQuestions('${treatmentName}')" 
                                class="w-full bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded-lg text-sm font-medium transition-colors">
                            ‚ùì Ver Outras D√∫vidas
                        </button>
                    </div>
                </div>
            `;
            
            container.appendChild(followUpDiv);
            scrollToBottom();
        }



        function askQuestion(treatmentName) {
            // Redirect to new frequent questions system
            showFrequentQuestions(treatmentName);
        }

        function showTreatmentBookingCard(treatmentName) {
            const container = document.getElementById('messagesContainer');
            const cardDiv = document.createElement('div');
            cardDiv.className = 'message flex items-start space-x-2 md:space-x-3';
            
            const treatment = Object.values(treatments).find(t => t.name === treatmentName);
            
            cardDiv.innerHTML = `
                <div class="w-6 h-6 md:w-8 md:h-8 bg-purple-500 rounded-full flex items-center justify-center flex-shrink-0">
                    <span class="text-white text-xs md:text-sm">ü§ñ</span>
                </div>
                <div class="bg-gradient-to-br from-white to-purple-50 border-2 border-purple-200 rounded-xl p-6 max-w-lg w-full shadow-lg">
                    <!-- Header do Procedimento -->
                    <div class="flex items-center space-x-4 mb-6">
                        <div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center">
                            <span class="text-3xl">${treatment.icon}</span>
                        </div>
                        <div class="flex-1">
                            <h3 class="text-xl font-bold text-gray-800">${treatment.name}</h3>
                            <p class="text-sm text-gray-600">${treatment.description}</p>
                        </div>
                    </div>
                    
                    <!-- Informa√ß√µes do Procedimento -->
                    <div class="space-y-4 mb-6">
                        <!-- Pre√ßo -->
                        <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h4 class="font-semibold text-green-800">üí∞ Investimento</h4>
                                    <p class="text-2xl font-bold text-green-600">R$ ${treatment.price},00</p>
                                </div>
                                <div class="text-right text-sm text-green-700">
                                    <p>‚è±Ô∏è ${treatment.duration} minutos</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Formas de Pagamento -->
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                            <h4 class="font-semibold text-blue-800 mb-3">üí≥ Formas de Pagamento</h4>
                            <div class="grid grid-cols-2 gap-2 text-sm text-blue-700">
                                <div class="flex items-center space-x-2">
                                    <span>üíµ</span>
                                    <span>Dinheiro</span>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <span>üí≥</span>
                                    <span>Cart√£o de D√©bito</span>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <span>üí≥</span>
                                    <span>Cart√£o de Cr√©dito</span>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <span>üì±</span>
                                    <span>PIX</span>
                                </div>
                            </div>
                            <div class="mt-2 text-xs text-blue-600">
                                ‚ú® Parcelamento em at√© 3x sem juros no cart√£o
                            </div>
                        </div>
                        
                        <!-- Benef√≠cios Resumidos -->
                        <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                            <h4 class="font-semibold text-purple-800 mb-2">‚ú® Principais Benef√≠cios</h4>
                            <div class="text-sm text-purple-700 space-y-1">
                                ${getBenefitsSummary(treatment.detailedExplanation)}
                            </div>
                        </div>
                    </div>
                    
                    <!-- Bot√µes de A√ß√£o -->
                    <div class="space-y-3">
                        <button onclick="proceedToCalendar('${treatmentName}')" 
                                class="w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white py-4 px-6 rounded-lg font-bold text-lg transition-colors shadow-lg">
                            üìÖ Escolher Data e Hor√°rio
                        </button>
                        
                        <div class="grid grid-cols-2 gap-3">
                            <button onclick="showFrequentQuestions('${treatment.name}')" 
                                    class="bg-gradient-to-r from-blue-500 to-indigo-500 hover:from-blue-600 hover:to-indigo-600 text-white py-3 px-4 rounded-lg font-medium transition-colors text-center">
                                ‚ùì Tirar D√∫vidas
                            </button>
                            
                            <button onclick="showClinicLocation()" 
                                    class="bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white py-3 px-4 rounded-lg font-medium transition-colors text-center">
                                üìç Ver Localiza√ß√£o
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            container.appendChild(cardDiv);
            scrollToBottom();
        }

        function getBenefitsSummary(detailedExplanation) {
            // Extract benefits from detailed explanation
            const benefits = [
                '‚Ä¢ Resultado imediato e duradouro',
                '‚Ä¢ Procedimento seguro e eficaz', 
                '‚Ä¢ Profissionais especializados',
                '‚Ä¢ Equipamentos de √∫ltima gera√ß√£o'
            ];
            
            return benefits.map(benefit => `<div>${benefit}</div>`).join('');
        }

        function proceedToCalendar(treatmentName) {
            const message = `Vou escolher data e hor√°rio para: ${treatmentName}`;
            addMessage(message, 'user');
            
            setTimeout(() => {
                const response = `Perfeito! Agora vou mostrar nosso calend√°rio com as datas e hor√°rios dispon√≠veis! üìÖ`;
                addMessage(response, 'bot');
                
                setTimeout(() => {
                    showCalendarBooking(treatmentName);
                }, 1000);
            }, 1000);
        }

        function showMoreInfo(treatmentName) {
            const treatment = Object.values(treatments).find(t => t.name === treatmentName);
            const message = `Quero saber mais detalhes sobre: ${treatmentName}`;
            addMessage(message, 'user');
            
            setTimeout(() => {
                addMessage(treatment.detailedExplanation, 'bot');
            }, 1000);
        }

        function showCalendarBooking(treatmentName) {
            const container = document.getElementById('messagesContainer');
            const calendarDiv = document.createElement('div');
            calendarDiv.className = 'message flex items-start space-x-2 md:space-x-3';
            
            const treatment = Object.values(treatments).find(t => t.name === treatmentName);
            const availableDates = getAdminAvailableDates();
            
            calendarDiv.innerHTML = `
                <div class="w-6 h-6 md:w-8 md:h-8 bg-purple-500 rounded-full flex items-center justify-center flex-shrink-0">
                    <span class="text-white text-xs md:text-sm">ü§ñ</span>
                </div>
                <div class="bg-white border-2 border-purple-200 rounded-xl p-6 max-w-2xl w-full shadow-lg">
                    <!-- Header -->
                    <div class="flex items-center space-x-3 mb-6">
                        <span class="text-2xl">${treatment.icon}</span>
                        <div>
                            <h3 class="font-bold text-gray-800">${treatmentName}</h3>
                            <p class="text-sm text-gray-600">R$ ${treatment.price} ‚Ä¢ ${treatment.duration} min</p>
                        </div>
                    </div>
                    
                    <!-- Calend√°rio -->
                    <div class="mb-6">
                        <h4 class="font-semibold text-gray-800 mb-4">üìÖ Escolha a Data</h4>
                        <div class="grid grid-cols-3 md:grid-cols-4 gap-3" id="dateGrid">
                            ${availableDates.map(date => `
                                <button onclick="selectDate('${date.value}', '${date.label}')" 
                                        class="date-option p-3 border-2 border-gray-200 hover:border-purple-500 hover:bg-purple-50 rounded-lg text-center transition-colors">
                                    <div class="text-xs text-gray-600">${date.weekday}</div>
                                    <div class="font-semibold text-gray-800">${date.day}</div>
                                    <div class="text-xs text-gray-600">${date.month}</div>
                                </button>
                            `).join('')}
                        </div>
                    </div>
                    
                    <!-- Hor√°rios (inicialmente oculto) -->
                    <div id="timeSelection" class="hidden mb-6">
                        <h4 class="font-semibold text-gray-800 mb-4">‚è∞ Escolha o Hor√°rio</h4>
                        <div class="grid grid-cols-3 md:grid-cols-4 gap-3" id="timeGrid">
                            <!-- Hor√°rios ser√£o carregados dinamicamente -->
                        </div>
                    </div>
                    
                    <!-- Formul√°rio de Dados (inicialmente oculto) -->
                    <div id="clientDataForm" class="hidden">
                        <h4 class="font-semibold text-gray-800 mb-4">üë§ Seus Dados</h4>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Nome completo:</label>
                                <input type="text" id="finalClientName" required 
                                       class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-purple-500"
                                       placeholder="Ex: Maria Silva Santos">
                                <div class="text-xs text-gray-500 mt-1">‚ö†Ô∏è Digite nome e sobrenome completos</div>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">WhatsApp:</label>
                                <input type="tel" id="finalClientPhone" required 
                                       class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-purple-500"
                                       placeholder="(11) 99999-9999">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Forma de Pagamento:</label>
                                <select id="paymentMethod" required 
                                        class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-purple-500">
                                    <option value="">Selecione a forma de pagamento</option>
                                    <option value="dinheiro">üíµ Dinheiro</option>
                                    <option value="debito">üí≥ Cart√£o de D√©bito</option>
                                    <option value="credito_1x">üí≥ Cart√£o de Cr√©dito (1x)</option>
                                    <option value="credito_2x">üí≥ Cart√£o de Cr√©dito (2x sem juros)</option>
                                    <option value="credito_3x">üí≥ Cart√£o de Cr√©dito (3x sem juros)</option>
                                    <option value="pix">üì± PIX</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">üì± Lembrete por WhatsApp:</label>
                                <select id="reminderOption" required 
                                        class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-purple-500">
                                    <option value="">Escolha quando receber o lembrete</option>
                                    <option value="1_day_before">üìÖ 1 dia antes √†s 08:00</option>
                                    <option value="same_day">‚è∞ No dia do procedimento √†s 08:00</option>
                                    <option value="both">üì± Ambos (1 dia antes + no dia)</option>
                                    <option value="no_reminder">üö´ N√£o quero receber lembretes</option>
                                </select>
                                <div class="text-xs text-purple-600 mt-1">
                                    üí° O lembrete ser√° enviado automaticamente para seu WhatsApp
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Observa√ß√µes (opcional):</label>
                                <textarea id="finalAppointmentNotes" rows="2" 
                                          class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-purple-500"
                                          placeholder="Alguma observa√ß√£o especial?"></textarea>
                            </div>
                            
                            <button type="button" onclick="finalizeBooking('${treatmentName}')" 
                                    class="w-full bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white py-4 px-6 rounded-lg font-bold text-lg transition-colors shadow-lg">
                                ‚úÖ Finalizar Agendamento
                            </button>
                        </div>
                    </div>
                    
                    <!-- Resumo da Sele√ß√£o -->
                    <div id="selectionSummary" class="hidden mt-4 p-4 bg-purple-50 border border-purple-200 rounded-lg">
                        <h5 class="font-semibold text-purple-800 mb-2">üìã Resumo da Sele√ß√£o</h5>
                        <div id="summaryContent" class="text-sm text-purple-700">
                            <!-- Conte√∫do ser√° preenchido dinamicamente -->
                        </div>
                    </div>
                </div>
            `;
            
            container.appendChild(calendarDiv);
            scrollToBottom();
        }

        let selectedBookingData = {
            treatment: '',
            date: '',
            time: '',
            dateLabel: '',
            timeLabel: ''
        };

        function selectDate(dateValue, dateLabel) {
            selectedBookingData.date = dateValue;
            selectedBookingData.dateLabel = dateLabel;
            
            // Highlight selected date
            document.querySelectorAll('.date-option').forEach(btn => {
                btn.classList.remove('border-purple-500', 'bg-purple-100');
                btn.classList.add('border-gray-200');
            });
            
            // Find the clicked button and highlight it
            const clickedButton = event ? event.target.closest('.date-option') : 
                                 document.querySelector(`[onclick="selectDate('${dateValue}', '${dateLabel}')"]`);
            if (clickedButton) {
                clickedButton.classList.remove('border-gray-200');
                clickedButton.classList.add('border-purple-500', 'bg-purple-100');
            }
            
            // Show time selection
            const timeSelection = document.getElementById('timeSelection');
            if (timeSelection) {
                timeSelection.classList.remove('hidden');
                loadAvailableTimes(dateValue);
                updateSelectionSummary();
                
                // Scroll to time selection
                setTimeout(() => {
                    timeSelection.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                }, 100);
            }
        }

        function loadAvailableTimes(date) {
            const timeGrid = document.getElementById('timeGrid');
            const availableTimes = getAdminAvailableTimes(date);
            
            timeGrid.innerHTML = availableTimes.map(time => `
                <button onclick="selectTime('${time.value}', '${time.label}')" 
                        class="time-option p-3 border-2 border-gray-200 hover:border-purple-500 hover:bg-purple-50 rounded-lg text-center transition-colors ${time.available ? '' : 'opacity-50 cursor-not-allowed'}"
                        ${time.available ? '' : 'disabled'}>
                    <div class="font-semibold text-gray-800">${time.label}</div>
                    <div class="text-xs ${time.available ? 'text-green-600' : 'text-red-600'}">
                        ${time.available ? 'Dispon√≠vel' : 'Ocupado'}
                    </div>
                </button>
            `).join('');
        }

        function selectTime(timeValue, timeLabel) {
            selectedBookingData.time = timeValue;
            selectedBookingData.timeLabel = timeLabel;
            
            // Highlight selected time
            document.querySelectorAll('.time-option').forEach(btn => {
                btn.classList.remove('border-purple-500', 'bg-purple-100');
                btn.classList.add('border-gray-200');
            });
            
            // Find the clicked button and highlight it
            const clickedButton = event ? event.target.closest('.time-option') : 
                                 document.querySelector(`[onclick="selectTime('${timeValue}', '${timeLabel}')"]`);
            if (clickedButton) {
                clickedButton.classList.remove('border-gray-200');
                clickedButton.classList.add('border-purple-500', 'bg-purple-100');
            }
            
            // Show client data form
            const clientDataForm = document.getElementById('clientDataForm');
            if (clientDataForm) {
                clientDataForm.classList.remove('hidden');
                updateSelectionSummary();
                
                // Scroll to form
                setTimeout(() => {
                    clientDataForm.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                }, 100);
            }
        }

        function updateSelectionSummary() {
            const summary = document.getElementById('selectionSummary');
            const content = document.getElementById('summaryContent');
            
            if (selectedBookingData.date || selectedBookingData.time) {
                summary.classList.remove('hidden');
                
                let summaryText = '';
                if (selectedBookingData.date) {
                    summaryText += `üìÖ Data: ${selectedBookingData.dateLabel}<br>`;
                }
                if (selectedBookingData.time) {
                    summaryText += `‚è∞ Hor√°rio: ${selectedBookingData.timeLabel}<br>`;
                }
                
                content.innerHTML = summaryText;
            }
        }

        function getAdminAvailableDates() {
            // Simula datas dispon√≠veis configuradas pelo administrador
            const dates = [];
            const today = new Date();
            
            // Pr√≥ximos 21 dias (exceto domingos e alguns dias bloqueados)
            for (let i = 1; i <= 21; i++) {
                const date = new Date(today);
                date.setDate(today.getDate() + i);
                
                // Skip Sundays and some blocked dates
                if (date.getDay() !== 0 && !isBlockedDate(date)) {
                    const day = date.getDate().toString().padStart(2, '0');
                    const month = (date.getMonth() + 1).toString().padStart(2, '0');
                    const year = date.getFullYear();
                    
                    const weekdays = ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'S√°b'];
                    const months = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'];
                    
                    dates.push({
                        value: `${day}/${month}/${year}`,
                        label: `${weekdays[date.getDay()]}, ${day}/${month}`,
                        weekday: weekdays[date.getDay()],
                        day: day,
                        month: months[date.getMonth()]
                    });
                }
            }
            
            return dates;
        }

        function isBlockedDate(date) {
            // Simula algumas datas bloqueadas pelo administrador
            const blockedDates = [
                // Adicione datas espec√≠ficas que o admin bloqueou
            ];
            
            const dateStr = date.toISOString().split('T')[0];
            return blockedDates.includes(dateStr);
        }

        function getAdminAvailableTimes(selectedDate) {
            // Simula hor√°rios dispon√≠veis configurados pelo administrador
            const allTimes = [
                { value: '09:00', label: '09:00' },
                { value: '10:00', label: '10:00' },
                { value: '11:00', label: '11:00' },
                { value: '14:00', label: '14:00' },
                { value: '15:00', label: '15:00' },
                { value: '16:00', label: '16:00' },
                { value: '17:00', label: '17:00' },
                { value: '18:00', label: '18:00' }
            ];
            
            // Simula alguns hor√°rios ocupados
            const occupiedTimes = ['10:00', '15:00']; // Exemplo de hor√°rios ocupados
            
            return allTimes.map(time => ({
                ...time,
                available: !occupiedTimes.includes(time.value)
            }));
        }

        function finalizeBooking(treatmentName) {
            const clientName = document.getElementById('finalClientName').value.trim();
            const clientPhone = document.getElementById('finalClientPhone').value;
            const paymentMethod = document.getElementById('paymentMethod').value;
            const reminderOption = document.getElementById('reminderOption').value;
            const notes = document.getElementById('finalAppointmentNotes').value;
            
            if (!clientName || !clientPhone || !paymentMethod || !reminderOption || !selectedBookingData.date || !selectedBookingData.time) {
                alert('Por favor, preencha todos os campos obrigat√≥rios!');
                return;
            }
            
            // Validar nome completo (deve ter pelo menos nome e sobrenome)
            const nameParts = clientName.split(' ').filter(part => part.length > 0);
            if (nameParts.length < 2) {
                alert('‚ö†Ô∏è Por favor, digite seu nome completo (nome e sobrenome).\n\nExemplo: Maria Silva');
                document.getElementById('finalClientName').focus();
                return;
            }
            
            // Verificar se n√£o s√£o apenas iniciais
            const hasValidName = nameParts.some(part => part.length >= 2);
            if (!hasValidName) {
                alert('‚ö†Ô∏è Por favor, digite seu nome completo por extenso.\n\nEvite usar apenas iniciais.');
                document.getElementById('finalClientName').focus();
                return;
            }
            
            const treatment = Object.values(treatments).find(t => t.name === treatmentName);
            const appointmentId = 'APT' + Date.now().toString().slice(-6);
            
            // Prepare reminder settings
            const reminderOptions = {
                '1_day_before': 'üìÖ 1 dia antes √†s 08:00',
                'same_day': '‚è∞ No dia do procedimento √†s 08:00',
                'both': 'üì± Ambos (1 dia antes + no dia)',
                'no_reminder': 'üö´ Sem lembretes'
            };
            
            // Prepare WhatsApp message for admin
            const paymentMethods = {
                'dinheiro': 'üíµ Dinheiro',
                'debito': 'üí≥ Cart√£o de D√©bito',
                'credito_1x': 'üí≥ Cart√£o de Cr√©dito (1x)',
                'credito_2x': 'üí≥ Cart√£o de Cr√©dito (2x sem juros)',
                'credito_3x': 'üí≥ Cart√£o de Cr√©dito (3x sem juros)',
                'pix': 'üì± PIX'
            };
            
            const whatsappMessage = `ü§ñ *NOVO AGENDAMENTO PELO CHATBOT*

üìã *ID:* ${appointmentId}
üë§ *Cliente:* ${clientName}
üì± *WhatsApp:* ${clientPhone}

‚ú® *Procedimento:* ${treatmentName}
üí∞ *Valor:* R$ ${treatment.price},00
‚è±Ô∏è *Dura√ß√£o:* ${treatment.duration} minutos

üìÖ *Data:* ${selectedBookingData.dateLabel}
‚è∞ *Hor√°rio:* ${selectedBookingData.timeLabel}

üí≥ *Forma de Pagamento:* ${paymentMethods[paymentMethod]}

üì± *Lembrete WhatsApp:* ${reminderOptions[reminderOption]}

${notes ? `üìù *Observa√ß√µes:* ${notes}` : ''}

üîî *A√ß√£o Necess√°ria:*
‚Ä¢ Confirmar disponibilidade
‚Ä¢ Entrar em contato com o cliente
‚Ä¢ Atualizar agenda
${reminderOption !== 'no_reminder' ? '‚Ä¢ Programar lembretes autom√°ticos' : ''}

_Agendamento feito automaticamente pelo ChatBot_`;
            
            // Send to admin WhatsApp
            sendToAdminWhatsApp(whatsappMessage);
            
            // Show confirmation to client
            setTimeout(() => {
                const confirmationMessage = `‚úÖ **AGENDAMENTO REALIZADO COM SUCESSO!**

üéâ **Parab√©ns! Seu procedimento est√° agendado:**
‚Ä¢ **ID:** ${appointmentId}
‚Ä¢ **Procedimento:** ${treatmentName}
‚Ä¢ **Data:** ${selectedBookingData.dateLabel}
‚Ä¢ **Hor√°rio:** ${selectedBookingData.timeLabel}
‚Ä¢ **Valor:** R$ ${treatment.price},00
‚Ä¢ **Pagamento:** ${paymentMethods[paymentMethod]}

üì± **Pr√≥ximos passos:**
‚Ä¢ Anote o ID do agendamento: ${appointmentId}
‚Ä¢ Entre em contato conosco para confirma√ß√£o final
‚Ä¢ WhatsApp: ${clinicSettings.whatsapp}
${reminderOption !== 'no_reminder' ? `‚Ä¢ ${reminderOptions[reminderOption]} (se solicitado)` : ''}

üí° **Lembre-se:** Chegue 10 minutos antes do hor√°rio!

üåü **Obrigada por escolher nossa cl√≠nica!**`;

                addMessage(confirmationMessage, 'bot');
                
                // Update stats
                const currentCount = parseInt(document.getElementById('todayAppointments').textContent);
                document.getElementById('todayAppointments').textContent = currentCount + 1;
                
            }, 1000);
        }

        function scheduleReminders(clientName, clientPhone, treatmentName, bookingData, reminderOption, appointmentId) {
            // Static function - no actual reminder scheduling
            showNotification('Op√ß√£o de lembrete registrada!', 'info');
        }

        function generateReminderMessages(clientName, treatmentName, bookingData, appointmentId) {
            const firstName = clientName.split(' ')[0];
            
            const dayBeforeMessage = `üåü Ol√° ${firstName}!

üìÖ *LEMBRETE DE AGENDAMENTO*

Voc√™ tem um procedimento agendado para *AMANH√É*:

‚ú® *Procedimento:* ${treatmentName}
üìÖ *Data:* ${bookingData.dateLabel}
‚è∞ *Hor√°rio:* ${bookingData.timeLabel}
üè¢ *Local:* ${clinicSettings.name}

üìç *Endere√ßo:*
${clinicSettings.address.replace(/\n/g, '\n')}

üí° *Lembretes importantes:*
‚Ä¢ Chegue 10 minutos antes
‚Ä¢ Traga um documento com foto
‚Ä¢ Vista roupas confort√°veis

‚ùì D√∫vidas ou precisar remarcar?
üì± Responda esta mensagem!

_ID: ${appointmentId}_`;

            const sameDayMessage = `‚è∞ Bom dia ${firstName}!

üåü *SEU PROCEDIMENTO √â HOJE!*

‚ú® *Procedimento:* ${treatmentName}
‚è∞ *Hor√°rio:* ${bookingData.timeLabel}
üè¢ *Local:* ${clinicSettings.name}

üìç *Endere√ßo:*
${clinicSettings.address.replace(/\n/g, '\n')}

üöó *Saindo de casa?*
‚Ä¢ Chegue 10 minutos antes
‚Ä¢ Traga documento com foto
‚Ä¢ Estamos te esperando!

üì± Qualquer imprevisto, nos avise!

_ID: ${appointmentId}_`;

            return {
                dayBefore: dayBeforeMessage,
                sameDay: sameDayMessage
            };
        }

        function sendToAdminWhatsApp(message) {
            // Static function - no actual WhatsApp integration
            showNotification('Agendamento processado com sucesso!', 'success');
        }

        function showWhatsAppAlternatives(message, phoneNumber, whatsappWebUrl) {
            // Static function - no WhatsApp alternatives needed
            return;
        }

        function copyAgendamentoMessage(message) {
            navigator.clipboard.writeText(message).then(() => {
                showNotification('‚úÖ Mensagem copiada! Agora cole no WhatsApp manualmente.', 'success');
                
                // Show additional instructions
                setTimeout(() => {
                    showNotification(`üì± Abra o WhatsApp e envie para: ${clinicSettings.phone}`, 'info');
                }, 2000);
            }).catch(() => {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = message;
                textArea.style.position = 'fixed';
                textArea.style.left = '-999999px';
                textArea.style.top = '-999999px';
                document.body.appendChild(textArea);
                textArea.focus();
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showNotification('‚úÖ Mensagem copiada! Cole no WhatsApp manualmente.', 'success');
            });
        }

        function showWhatsAppWebFallback(message, phoneNumber) {
            const container = document.getElementById('messagesContainer');
            const fallbackDiv = document.createElement('div');
            fallbackDiv.className = 'message flex items-start space-x-2 md:space-x-3';
            
            const whatsappWebUrl = `https://web.whatsapp.com/send?phone=55${phoneNumber}&text=${encodeURIComponent(message)}`;
            
            fallbackDiv.innerHTML = `
                <div class="w-6 h-6 md:w-8 md:h-8 bg-purple-500 rounded-full flex items-center justify-center flex-shrink-0">
                    <span class="text-white text-xs md:text-sm">ü§ñ</span>
                </div>
                <div class="bg-gradient-to-br from-yellow-50 to-orange-50 border-2 border-orange-300 rounded-xl p-6 max-w-lg w-full shadow-lg">
                    <div class="flex items-center space-x-3 mb-4">
                        <span class="text-2xl">‚ö†Ô∏è</span>
                        <div>
                            <h3 class="font-bold text-orange-800">WhatsApp n√£o dispon√≠vel</h3>
                            <p class="text-sm text-orange-700">O app do WhatsApp pode estar bloqueado ou indispon√≠vel</p>
                        </div>
                    </div>
                    
                    <div class="space-y-4">
                        <div class="bg-white border border-orange-200 rounded-lg p-4">
                            <h4 class="font-semibold text-gray-800 mb-2">üí° Alternativas dispon√≠veis:</h4>
                            <div class="space-y-3">
                                <a href="${whatsappWebUrl}" target="_blank" 
                                   class="block w-full bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white py-3 px-4 rounded-lg font-medium transition-colors text-center">
                                    üåê Abrir WhatsApp Web
                                </a>
                                
                                <button onclick="copyMessageToClipboard(\`${message.replace(/`/g, '\\`')}\`)" 
                                        class="w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white py-3 px-4 rounded-lg font-medium transition-colors">
                                    üìã Copiar Mensagem
                                </button>
                                
                                <div class="text-center">
                                    <p class="text-sm text-gray-600 mb-2">Ou ligue diretamente:</p>
                                    <a href="tel:${clinicSettings.phone}" 
                                       class="inline-block bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white py-2 px-6 rounded-lg font-medium transition-colors">
                                        üìû ${clinicSettings.phone}
                                    </a>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-3">
                            <p class="text-xs text-blue-700">
                                <strong>üí° Dica:</strong> Se estiver no computador, use o WhatsApp Web. 
                                Se estiver no celular, copie a mensagem e cole no WhatsApp manualmente.
                            </p>
                        </div>
                    </div>
                </div>
            `;
            
            container.appendChild(fallbackDiv);
            scrollToBottom();
            
            showNotification('WhatsApp indispon√≠vel. Veja as alternativas acima!', 'info');
        }

        function copyMessageToClipboard(message) {
            navigator.clipboard.writeText(message).then(() => {
                showNotification('Mensagem copiada! Cole no WhatsApp manualmente.', 'success');
            }).catch(() => {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = message;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showNotification('Mensagem copiada! Cole no WhatsApp manualmente.', 'success');
            });
        }

        function generateAvailableDates() {
            const dates = [];
            const today = new Date();
            
            for (let i = 1; i <= 14; i++) {
                const date = new Date(today);
                date.setDate(today.getDate() + i);
                
                // Skip Sundays
                if (date.getDay() !== 0) {
                    const day = date.getDate().toString().padStart(2, '0');
                    const month = (date.getMonth() + 1).toString().padStart(2, '0');
                    const year = date.getFullYear();
                    
                    const weekdays = ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'S√°b'];
                    const weekday = weekdays[date.getDay()];
                    
                    dates.push({
                        value: `${day}/${month}/${year}`,
                        label: `${weekday}, ${day}/${month}`
                    });
                }
            }
            
            return dates;
        }

        function confirmAppointment(treatmentName) {
            const clientName = document.getElementById('clientName').value;
            const clientPhone = document.getElementById('clientPhone').value;
            const appointmentDate = document.getElementById('appointmentDate').value;
            const appointmentTime = document.getElementById('appointmentTime').value;
            const appointmentNotes = document.getElementById('appointmentNotes').value;
            
            if (!clientName || !clientPhone || !appointmentDate || !appointmentTime) {
                alert('Por favor, preencha todos os campos obrigat√≥rios!');
                return;
            }
            
            // Generate appointment ID
            const appointmentId = 'APT' + Date.now().toString().slice(-6);
            
            // Add to appointments list
            const treatment = Object.values(treatments).find(t => t.name === treatmentName);
            const newAppointment = {
                id: appointmentId,
                client: clientName,
                phone: clientPhone,
                treatment: treatmentName,
                price: treatment.price,
                date: appointmentDate,
                time: appointmentTime,
                notes: appointmentNotes,
                status: 'Confirmado',
                createdAt: new Date().toISOString()
            };
            
            // Save appointment (in real app, this would go to database)
            if (!window.appointments) window.appointments = [];
            window.appointments.push(newAppointment);
            
            // Show confirmation message
            setTimeout(() => {
                const confirmationMessage = `‚úÖ **AGENDAMENTO CONFIRMADO!**

üìã **Detalhes do seu agendamento:**
‚Ä¢ **ID:** ${appointmentId}
‚Ä¢ **Cliente:** ${clientName}
‚Ä¢ **Procedimento:** ${treatmentName}
‚Ä¢ **Data:** ${appointmentDate}
‚Ä¢ **Hor√°rio:** ${appointmentTime}
‚Ä¢ **Valor:** R$ ${treatment.price}

üì± **Pr√≥ximos passos:**
‚Ä¢ Voc√™ receber√° uma confirma√ß√£o no WhatsApp
‚Ä¢ Lembrete ser√° enviado 1 dia antes
‚Ä¢ Em caso de d√∫vidas, entre em contato conosco

üí° **Importante:** Chegue 10 minutos antes do hor√°rio agendado!`;

                addMessage(confirmationMessage, 'bot');
                
                // Update stats
                const currentCount = parseInt(document.getElementById('todayAppointments').textContent);
                document.getElementById('todayAppointments').textContent = currentCount + 1;
                
                // Add to appointments tab
                updateAppointmentsList();
                
                // Show WhatsApp confirmation option
                setTimeout(() => {
                    showWhatsAppConfirmation(newAppointment);
                }, 2000);
                
            }, 1000);
        }

        function showWhatsAppConfirmation(appointment) {
            const container = document.getElementById('messagesContainer');
            const buttonDiv = document.createElement('div');
            buttonDiv.className = 'message flex items-start space-x-2 md:space-x-3';
            
            const whatsappNumber = clinicSettings.whatsapp.replace(/\D/g, '');
            const message = `Ol√°! Meu agendamento foi confirmado:

üìã ID: ${appointment.id}
üë§ ${appointment.client}
‚ú® ${appointment.treatment}
üìÖ ${appointment.date} √†s ${appointment.time}
üí∞ R$ ${appointment.price}

Aguardo a confirma√ß√£o!`;
            
            const whatsappUrl = `https://wa.me/55${whatsappNumber}?text=${encodeURIComponent(message)}`;
            
            buttonDiv.innerHTML = `
                <div class="w-6 h-6 md:w-8 md:h-8 bg-purple-500 rounded-full flex items-center justify-center flex-shrink-0">
                    <span class="text-white text-xs md:text-sm">ü§ñ</span>
                </div>
                <div class="bg-gray-100 rounded-lg mobile-p-3 p-4 max-w-md">
                    <p class="text-sm text-gray-700 mb-3">Quer receber a confirma√ß√£o no WhatsApp?</p>
                    <a href="${whatsappUrl}" target="_blank" 
                       class="inline-block w-full bg-green-500 hover:bg-green-600 text-white text-center py-3 px-6 rounded-lg font-medium transition-colors">
                        üí¨ Enviar para WhatsApp
                    </a>
                </div>
            `;
            
            container.appendChild(buttonDiv);
            scrollToBottom();
        }

        function showWhatsAppButton(message = '') {
            const container = document.getElementById('messagesContainer');
            const buttonDiv = document.createElement('div');
            buttonDiv.className = 'message flex items-start space-x-2 md:space-x-3';
            
            const whatsappNumber = clinicSettings.whatsapp.replace(/\D/g, '');
            const whatsappUrl = `https://wa.me/55${whatsappNumber}?text=${encodeURIComponent(message)}`;
            
            buttonDiv.innerHTML = `
                <div class="w-6 h-6 md:w-8 md:h-8 bg-purple-500 rounded-full flex items-center justify-center flex-shrink-0">
                    <span class="text-white text-xs md:text-sm">ü§ñ</span>
                </div>
                <div class="bg-gray-100 rounded-lg mobile-p-3 p-4 max-w-md">
                    <a href="${whatsappUrl}" target="_blank" 
                       class="inline-block w-full bg-green-500 hover:bg-green-600 text-white text-center py-3 px-6 rounded-lg font-medium transition-colors">
                        üí¨ Continuar no WhatsApp
                    </a>
                </div>
            `;
            
            container.appendChild(buttonDiv);
            scrollToBottom();
        }

        function scrollToBottom() {
            const container = document.getElementById('chatContainer');
            if (container) {
                container.scrollTop = container.scrollHeight;
            }
        }

        // Treatment Management
        function loadTreatmentsList() {
            const container = document.getElementById('treatmentsList');
            if (!container) return;
            
            container.innerHTML = '';
            
            Object.values(treatments).forEach(treatment => {
                const treatmentCard = document.createElement('div');
                treatmentCard.className = 'treatment-card bg-white border border-gray-200 rounded-lg p-6 hover:shadow-lg transition-all';
                
                treatmentCard.innerHTML = `
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center">
                            <span class="text-2xl">${treatment.icon}</span>
                        </div>
                        <div class="flex space-x-2">
                            <button onclick="editTreatment('${treatment.id}')" class="text-blue-600 hover:text-blue-800 text-sm">
                                ‚úèÔ∏è Editar
                            </button>
                            <button onclick="deleteTreatment('${treatment.id}')" class="text-red-600 hover:text-red-800 text-sm">
                                üóëÔ∏è Excluir
                            </button>
                        </div>
                    </div>
                    
                    <h4 class="text-lg font-semibold text-gray-800 mb-2">${treatment.name}</h4>
                    <p class="text-gray-600 text-sm mb-3">${treatment.description}</p>
                    
                    <div class="flex justify-between items-center text-sm mb-3">
                        <span class="text-green-600 font-semibold">R$ ${treatment.price}</span>
                        <span class="text-gray-500">${treatment.duration} min</span>
                    </div>
                    
                    ${treatment.detailedExplanation ? `
                        <div class="mt-3 p-3 bg-gray-50 rounded-lg">
                            <div class="text-xs text-gray-600 mb-1">üìã Explica√ß√£o Detalhada:</div>
                            <div class="text-xs text-gray-700 max-h-20 overflow-hidden">
                                ${treatment.detailedExplanation.substring(0, 100)}...
                            </div>
                        </div>
                    ` : ''}
                `;
                
                container.appendChild(treatmentCard);
            });
        }

        function openTreatmentModal(treatmentId = null) {
            editingTreatmentId = treatmentId;
            
            if (treatmentId && treatments[treatmentId]) {
                const treatment = treatments[treatmentId];
                document.getElementById('treatmentId').value = treatmentId;
                document.getElementById('treatmentName').value = treatment.name;
                document.getElementById('treatmentIcon').value = treatment.icon;
                document.getElementById('treatmentPrice').value = treatment.price;
                document.getElementById('treatmentDuration').value = treatment.duration;
                document.getElementById('treatmentDescription').value = treatment.description || '';
                document.getElementById('treatmentDetailedExplanation').value = treatment.detailedExplanation || '';
            } else {
                document.getElementById('treatmentForm').reset();
                document.getElementById('treatmentId').value = '';
            }
            
            document.getElementById('treatmentModal').classList.remove('hidden');
            document.getElementById('treatmentModal').classList.add('flex');
        }

        function closeTreatmentModal() {
            document.getElementById('treatmentModal').classList.add('hidden');
            document.getElementById('treatmentModal').classList.remove('flex');
            editingTreatmentId = null;
        }

        function editTreatment(treatmentId) {
            openTreatmentModal(treatmentId);
        }

        function deleteTreatment(treatmentId) {
            if (confirm('Tem certeza que deseja excluir este procedimento?')) {
                delete treatments[treatmentId];
                loadTreatmentsList();
                showNotification('Procedimento exclu√≠do com sucesso!', 'success');
            }
        }

        function saveTreatment(event) {
            event.preventDefault();
            
            const id = document.getElementById('treatmentId').value || 'treatment_' + Date.now();
            const name = document.getElementById('treatmentName').value;
            const icon = document.getElementById('treatmentIcon').value || '‚ú®';
            const price = parseFloat(document.getElementById('treatmentPrice').value);
            const duration = parseInt(document.getElementById('treatmentDuration').value);
            const description = document.getElementById('treatmentDescription').value;
            const detailedExplanation = document.getElementById('treatmentDetailedExplanation').value;
            
            treatments[id] = {
                id: id,
                name: name,
                icon: icon,
                price: price,
                duration: duration,
                description: description,
                detailedExplanation: detailedExplanation
            };
            
            loadTreatmentsList();
            closeTreatmentModal();
            showNotification('Procedimento salvo com sucesso!', 'success');
        }

        // Link Generator Functions
        function generateChatbotLink() {
            const linkName = document.getElementById('linkName').value || 'bella-estetica';
            const whatsappNumber = document.getElementById('linkWhatsapp').value || clinicSettings.whatsapp;
            const theme = document.getElementById('linkTheme').value || 'purple';
            
            const shareableUrl = `https://chatbot.link/${linkName}`;
            
            document.getElementById('generatedLink').value = shareableUrl;
            
            const whatsappShareMsg = `ü§ñ *ChatBot da ${clinicSettings.name}*

Agende seus procedimentos de forma r√°pida e f√°cil!

‚ú® Tratamentos dispon√≠veis 24h
üìÖ Agendamento online instant√¢neo  
üí¨ Atendimento automatizado
üì± Direto para nosso WhatsApp

üëÜ *Clique aqui:* ${shareableUrl}

#Est√©tica #Beleza #Agendamento`;
            document.getElementById('whatsappShareMessage').value = whatsappShareMsg;
            
            showNotification('Link do ChatBot gerado com sucesso! üéâ', 'success');
        }
        
        function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            element.select();
            element.setSelectionRange(0, 99999);
            document.execCommand('copy');
            
            showNotification('Copiado para a √°rea de transfer√™ncia!', 'success');
        }
        
        function previewChatbot() {
            showNotification('Abrindo pr√©via do ChatBot...', 'success');
            // Simulate opening preview
            setTimeout(() => {
                alert('Pr√©via do ChatBot seria aberta em uma nova janela!');
            }, 1000);
        }
        
        function shareLinkOnSocial(platform) {
            const chatbotUrl = document.getElementById('generatedLink').value;
            const message = `ü§ñ Agende seus procedimentos na ${clinicSettings.name} atrav√©s do nosso ChatBot! ${chatbotUrl}`;
            
            let shareUrl = '';
            
            switch(platform) {
                case 'whatsapp':
                    shareUrl = `https://wa.me/?text=${encodeURIComponent(message)}`;
                    break;
            }
            
            if (shareUrl) {
                window.open(shareUrl, '_blank');
                showNotification(`Compartilhando no ${platform}...`, 'success');
            }
        }

        // Settings Functions
        function saveSettings() {
            clinicSettings.name = document.getElementById('clinicNameInput').value;
            clinicSettings.phone = document.getElementById('clinicPhone').value;
            clinicSettings.whatsapp = document.getElementById('clinicPhone').value; // Use same as phone
            clinicSettings.email = document.getElementById('clinicEmail').value;
            clinicSettings.address = document.getElementById('clinicAddress').value;
            
            // Update header
            document.getElementById('clinicName').textContent = clinicSettings.name;
            
            showNotification('Configura√ß√µes salvas com sucesso!', 'success');
        }

        // Admin Functions
        function manageAppointments() {
            switchTab('appointments');
            showNotification('Redirecionando para gerenciamento de agendamentos...', 'info');
        }

        function manageTreatments() {
            switchTab('treatments');
            showNotification('Redirecionando para gerenciamento de procedimentos...', 'info');
        }

        function sendReminders() {
            // Simulate sending reminders
            const appointments = [
                { client: 'Maria Silva', treatment: 'Limpeza de Pele', time: '14:00' },
                { client: 'Ana Costa', treatment: 'Massagem Relaxante', time: '10:00' }
            ];
            
            let remindersSent = 0;
            appointments.forEach((appointment, index) => {
                setTimeout(() => {
                    remindersSent++;
                    showNotification(`Lembrete enviado para ${appointment.client}`, 'success');
                    
                    if (remindersSent === appointments.length) {
                        setTimeout(() => {
                            showNotification(`Todos os ${appointments.length} lembretes foram enviados!`, 'success');
                        }, 500);
                    }
                }, (index + 1) * 1000);
            });
        }

        function manageSchedule() {
            switchTab('appointments');
            showNotification('Abrindo gerenciador de agenda...', 'info');
        }

        function updateAppointmentsList() {
            const appointmentsList = document.getElementById('appointmentsList');
            if (!appointmentsList || !window.appointments) return;
            
            // Keep existing appointments and add new ones
            const existingAppointments = appointmentsList.innerHTML;
            
            // Add new appointments from ChatBot
            window.appointments.forEach(appointment => {
                // Check if appointment already exists
                if (!appointmentsList.querySelector(`[data-id="${appointment.id}"]`)) {
                    const appointmentDiv = document.createElement('div');
                    appointmentDiv.className = 'border border-purple-200 bg-purple-50 rounded-lg p-4';
                    appointmentDiv.setAttribute('data-id', appointment.id);
                    
                    appointmentDiv.innerHTML = `
                        <div class="flex justify-between items-center">
                            <div>
                                <h4 class="font-semibold text-gray-800">${appointment.client}</h4>
                                <p class="text-sm text-gray-600">${appointment.treatment} - R$ ${appointment.price}</p>
                                <p class="text-xs text-gray-500">${appointment.date} √†s ${appointment.time}</p>
                                <p class="text-xs text-blue-600">üì± ${appointment.phone}</p>
                                ${appointment.notes ? `<p class="text-xs text-gray-600 mt-1">üìù ${appointment.notes}</p>` : ''}
                            </div>
                            <div class="text-right">
                                <span class="px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm">ü§ñ ChatBot</span>
                                <p class="text-xs text-gray-500 mt-1">ID: ${appointment.id}</p>
                                <p class="text-xs text-green-600 mt-1">‚úÖ ${appointment.status}</p>
                            </div>
                        </div>
                    `;
                    
                    // Insert at the beginning (most recent first)
                    appointmentsList.insertBefore(appointmentDiv, appointmentsList.firstChild);
                }
            });
        }

        // Analytics Functions
        function updateAnalytics() {
            // Simulate real-time data updates
            const stats = {
                appointments: Math.floor(Math.random() * 10) + 3,
                revenue: (Math.random() * 5000 + 10000).toFixed(0),
                clients: Math.floor(Math.random() * 50) + 100,
                clicks: Math.floor(Math.random() * 100) + 200,
                conversations: Math.floor(Math.random() * 80) + 150,
                appointmentsFromBot: Math.floor(Math.random() * 30) + 40,
                conversionRate: (Math.random() * 10 + 15).toFixed(1)
            };
            
            document.getElementById('todayAppointments').textContent = stats.appointments;
            document.getElementById('monthlyRevenue').textContent = `R$ ${stats.revenue}`;
            document.getElementById('activeClients').textContent = stats.clients;
            document.getElementById('linkClicks').textContent = stats.clicks;
            document.getElementById('linkConversations').textContent = stats.conversations;
            document.getElementById('linkAppointments').textContent = stats.appointmentsFromBot;
            document.getElementById('linkConversionRate').textContent = `${stats.conversionRate}%`;
            
            showNotification('Dados atualizados!', 'success');
        }

        // Auto-update analytics every 30 seconds
        setInterval(updateAnalytics, 30000);

        // WhatsApp Integration
        function openWhatsApp(message = '') {
            // Static function - no actual WhatsApp integration
            showNotification('WhatsApp: ' + clinicSettings.whatsapp, 'info');
        }

        function showWhatsAppWebOptions(message, phoneNumber, whatsappWebUrl) {
            // Static function - no WhatsApp web options needed
            return;
        }

        // Export Functions
        function exportAppointments() {
            const appointments = [
                { date: '15/01/2024', time: '14:00', client: 'Maria Silva', treatment: 'Limpeza de Pele', price: 'R$ 150', status: 'Confirmado' },
                { date: '16/01/2024', time: '10:00', client: 'Ana Costa', treatment: 'Massagem Relaxante', price: 'R$ 180', status: 'Pendente' },
                { date: '17/01/2024', time: '16:00', client: 'Carla Santos', treatment: 'Peeling Qu√≠mico', price: 'R$ 200', status: 'Confirmado' }
            ];
            
            let csvContent = 'Data,Hor√°rio,Cliente,Tratamento,Pre√ßo,Status\n';
            appointments.forEach(apt => {
                csvContent += `${apt.date},${apt.time},${apt.client},${apt.treatment},${apt.price},${apt.status}\n`;
            });
            
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'agendamentos.csv';
            a.click();
            URL.revokeObjectURL(url);
            
            showNotification('Agendamentos exportados com sucesso!', 'success');
        }

        // Backup Functions
        function backupData() {
            const backupData = {
                treatments: treatments,
                clinicSettings: clinicSettings,
                timestamp: new Date().toISOString(),
                version: '1.0'
            };
            
            const blob = new Blob([JSON.stringify(backupData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `backup-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            showNotification('Backup criado com sucesso!', 'success');
        }

        function restoreData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const backupData = JSON.parse(e.target.result);
                        
                        if (backupData.treatments) {
                            treatments = backupData.treatments;
                            loadTreatmentsList();
                        }
                        
                        if (backupData.clinicSettings) {
                            clinicSettings = backupData.clinicSettings;
                            document.getElementById('clinicNameInput').value = clinicSettings.name;
                            document.getElementById('clinicPhone').value = clinicSettings.phone;
                            document.getElementById('clinicEmail').value = clinicSettings.email;
                            document.getElementById('clinicAddress').value = clinicSettings.address;
                            document.getElementById('clinicName').textContent = clinicSettings.name;
                        }
                        
                        showNotification('Dados restaurados com sucesso!', 'success');
                    } catch (error) {
                        showNotification('Erro ao restaurar dados. Arquivo inv√°lido.', 'error');
                    }
                };
                reader.readAsText(file);
            };
            input.click();
        }

        // Advanced ChatBot Functions
        function trainChatbot() {
            showNotification('Iniciando treinamento do ChatBot...', 'info');
            
            setTimeout(() => {
                showNotification('ChatBot treinado com novos procedimentos!', 'success');
            }, 2000);
        }

        function resetChatbot() {
            if (confirm('Tem certeza que deseja resetar todas as conversas do ChatBot?')) {
                document.getElementById('messagesContainer').innerHTML = `
                    <div class="message flex items-start space-x-2 md:space-x-3">
                        <div class="w-6 h-6 md:w-8 md:h-8 bg-purple-500 rounded-full flex items-center justify-center flex-shrink-0">
                            <span class="text-white text-xs md:text-sm">ü§ñ</span>
                        </div>
                        <div class="bg-gray-100 rounded-lg mobile-p-3 p-4 mobile-max-w-xs max-w-xs">
                            <p class="text-gray-800 text-sm md:text-base">Ol√°! üëã Sou a assistente virtual da ${clinicSettings.name}. Como posso ajud√°-la hoje?</p>
                        </div>
                    </div>
                `;
                showNotification('ChatBot resetado com sucesso!', 'success');
            }
        }

        function showClinicLocation() {
            const message = 'Gostaria de ver a localiza√ß√£o da cl√≠nica';
            addMessage(message, 'user');
            
            setTimeout(() => {
                const response = `üìç Aqui est√° nossa localiza√ß√£o completa! Estamos esperando voc√™! üòä`;
                addMessage(response, 'bot');
                
                setTimeout(() => {
                    showLocationCard();
                }, 1000);
            }, 1000);
        }

        function showLocationCard() {
            const container = document.getElementById('messagesContainer');
            const locationDiv = document.createElement('div');
            locationDiv.className = 'message flex items-start space-x-2 md:space-x-3';
            
            // Endere√ßo da cl√≠nica (usando dados das configura√ß√µes)
            const address = clinicSettings.address.replace(/\n/g, ', ');
            const encodedAddress = encodeURIComponent(address);
            const googleMapsUrl = `https://www.google.com/maps/search/?api=1&query=${encodedAddress}`;
            const wazeUrl = `https://waze.com/ul?q=${encodedAddress}`;
            
            locationDiv.innerHTML = `
                <div class="w-6 h-6 md:w-8 md:h-8 bg-purple-500 rounded-full flex items-center justify-center flex-shrink-0">
                    <span class="text-white text-xs md:text-sm">ü§ñ</span>
                </div>
                <div class="bg-gradient-to-br from-white to-orange-50 border-2 border-orange-200 rounded-xl p-6 max-w-lg w-full shadow-lg">
                    <!-- Header da Localiza√ß√£o -->
                    <div class="flex items-center space-x-3 mb-4">
                        <span class="text-2xl">üìç</span>
                        <div>
                            <h3 class="text-lg font-bold text-gray-800">Nossa Localiza√ß√£o</h3>
                            <p class="text-sm text-gray-600">${clinicSettings.name}</p>
                        </div>
                    </div>
                    
                    <!-- Informa√ß√µes Essenciais -->
                    <div class="space-y-3 mb-4">
                        <!-- Endere√ßo -->
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-3">
                            <div class="flex items-start space-x-2">
                                <span class="text-lg">üè¢</span>
                                <div class="flex-1">
                                    <p class="text-blue-700 text-sm font-medium whitespace-pre-line">${clinicSettings.address}</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Contato e Hor√°rio -->
                        <div class="grid grid-cols-2 gap-3">
                            <div class="bg-green-50 border border-green-200 rounded-lg p-3 text-center">
                                <span class="text-lg block mb-1">üìû</span>
                                <p class="text-green-700 text-xs font-medium">${clinicSettings.phone}</p>
                            </div>
                            <div class="bg-purple-50 border border-purple-200 rounded-lg p-3 text-center">
                                <span class="text-lg block mb-1">üïí</span>
                                <p class="text-purple-700 text-xs font-medium">Seg-Sex: 9h-18h</p>
                                <p class="text-purple-700 text-xs">S√°b: 9h-16h</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Bot√µes de A√ß√£o -->
                    <div class="space-y-3">
                        <div class="grid grid-cols-2 gap-3">
                            <button class="bg-gradient-to-r from-blue-500 to-blue-600 text-white py-3 px-4 rounded-lg font-medium text-center text-sm cursor-default">
                                üó∫Ô∏è Google Maps
                            </button>
                            <button class="bg-gradient-to-r from-purple-500 to-purple-600 text-white py-3 px-4 rounded-lg font-medium text-center text-sm cursor-default">
                                üöó Waze
                            </button>
                        </div>
                        
                        <button onclick="showTreatmentDropdownFromLocation()" 
                                class="w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white py-3 px-6 rounded-lg font-bold transition-colors">
                            üìÖ Agendar Procedimento
                        </button>
                    </div>
                    
                    <!-- Dica R√°pida -->
                    <div class="mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg">
                        <p class="text-yellow-700 text-xs text-center">
                            üí° <strong>Dica:</strong> Estamos pr√≥ximos ao metr√¥ Rep√∫blica ‚Ä¢ Estacionamento dispon√≠vel na rua
                        </p>
                    </div>
                </div>
            `;
            
            container.appendChild(locationDiv);
            scrollToBottom();
        }



        function showTreatmentDropdownFromLocation() {
            const message = 'Quero agendar um procedimento';
            addMessage(message, 'user');
            
            setTimeout(() => {
                const response = 'Perfeito! Vou mostrar nossos procedimentos dispon√≠veis para agendamento! ‚ú®';
                addMessage(response, 'bot');
                
                setTimeout(() => {
                    showTreatmentDropdown();
                }, 1000);
            }, 1000);
        }

        function showContactCard() {
            const container = document.getElementById('messagesContainer');
            const contactDiv = document.createElement('div');
            contactDiv.className = 'message flex items-start space-x-2 md:space-x-3';
            
            contactDiv.innerHTML = `
                <div class="w-6 h-6 md:w-8 md:h-8 bg-purple-500 rounded-full flex items-center justify-center flex-shrink-0">
                    <span class="text-white text-xs md:text-sm">ü§ñ</span>
                </div>
                <div class="bg-gradient-to-br from-white to-green-50 border-2 border-green-200 rounded-xl p-4 max-w-md w-full shadow-lg">
                    <!-- Header -->
                    <div class="flex items-center space-x-3 mb-4">
                        <span class="text-2xl">üìû</span>
                        <div>
                            <h3 class="font-bold text-gray-800">Contato</h3>
                            <p class="text-sm text-gray-600">${clinicSettings.name}</p>
                        </div>
                    </div>
                    
                    <!-- WhatsApp Principal -->
                    <div class="bg-gradient-to-r from-green-500 to-green-600 rounded-lg p-3 text-white mb-3">
                        <div class="flex items-center space-x-2">
                            <span class="text-xl">üí¨</span>
                            <div>
                                <p class="font-bold">${clinicSettings.whatsapp}</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Outras Informa√ß√µes -->
                    <div class="space-y-2 mb-4 text-sm">
                        <div class="flex items-center space-x-2">
                            <span>üìû</span>
                            <span class="text-gray-700">${clinicSettings.phone}</span>
                            <span class="text-gray-500 text-xs">Seg-Sex 9h-18h</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <span>üìß</span>
                            <span class="text-gray-700 text-xs">${clinicSettings.email}</span>
                        </div>
                        <div class="flex items-start space-x-2">
                            <span>üìç</span>
                            <span class="text-gray-700 text-xs">${clinicSettings.address.replace(/\n/g, ', ')}</span>
                        </div>
                    </div>
                    
                    <!-- Bot√µes -->
                    <div class="space-y-2">
                        <button onclick="showTreatmentDropdownFromContact()" 
                                class="w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white py-3 rounded-lg font-bold transition-colors">
                            üìÖ Agendar Procedimento
                        </button>
                        
                        <div class="grid grid-cols-2 gap-2">
                            <button class="bg-blue-500 text-white py-2 rounded-lg text-center text-xs font-medium cursor-default">
                                üìû Ligar
                            </button>
                            <button onclick="showClinicLocation()" 
                                    class="bg-orange-500 hover:bg-orange-600 text-white py-2 rounded-lg text-xs font-medium transition-colors">
                                üìç Localiza√ß√£o
                            </button>
                        </div>
                        

                    </div>
                </div>
            `;
            
            container.appendChild(contactDiv);
            scrollToBottom();
        }

        function openWhatsAppFromContact() {
            const message = `Ol√°! Vi as informa√ß√µes de contato no ChatBot da ${clinicSettings.name} e gostaria de conversar com voc√™s.

Como posso ser ajudada?`;
            
            openWhatsApp(message);
        }

        function showTreatmentDropdownFromContact() {
            const message = 'Quero agendar um procedimento';
            addMessage(message, 'user');
            
            setTimeout(() => {
                const response = 'Perfeito! Vou mostrar nossos procedimentos dispon√≠veis para agendamento! ‚ú®';
                addMessage(response, 'bot');
                
                setTimeout(() => {
                    showTreatmentDropdownForScheduling();
                }, 1000);
            }, 1000);
        }

        function openWhatsAppLocation() {
            const message = `Ol√°! Vi a localiza√ß√£o da cl√≠nica no ChatBot e gostaria de tirar algumas d√∫vidas sobre como chegar.

üìç Endere√ßo: ${clinicSettings.address.replace(/\n/g, ', ')}

Podem me ajudar?`;
            
            openWhatsApp(message);
        }

        function contactForGeneralQuestions() {
            const message = `Ol√°! Tenho algumas d√∫vidas sobre os procedimentos da cl√≠nica que gostaria de esclarecer.

Podem me ajudar?`;
            
            openWhatsApp(message);
        }

        function contactForMoreQuestions(treatmentName) {
            const message = `Ol√°! Tenho algumas d√∫vidas sobre ${treatmentName} que n√£o foram esclarecidas no ChatBot.

Podem me ajudar com mais informa√ß√µes?`;
            
            openWhatsApp(message);
        }

        // Notification System
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification bg-white border-l-4 p-4 rounded-lg shadow-lg max-w-sm ${
                type === 'success' ? 'border-green-500' : 
                type === 'error' ? 'border-red-500' : 
                'border-blue-500'
            }`;
            
            const icon = type === 'success' ? '‚úÖ' : type === 'error' ? '‚ùå' : '‚ÑπÔ∏è';
            
            notification.innerHTML = `
                <div class="flex items-center space-x-3">
                    <span class="text-xl">${icon}</span>
                    <p class="text-gray-800 text-sm">${message}</p>
                    <button onclick="this.parentElement.parentElement.remove()" class="ml-auto text-gray-400 hover:text-gray-600">
                        √ó
                    </button>
                </div>
            `;
            
            document.getElementById('notifications').appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 5000);
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9784be27f620e2cf',t:'MTc1NjcyOTQ0Ny4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
